(function(c,m,k,n){var l=function(){return this.init.apply(this,arguments)};l.prototype={defaults:{onstatechange:function(){},ondragend:function(){},onbarclicked:function(){},isRange:!1,showLabels:!0,showScale:!0,step:1,format:"%s",theme:"theme-green",width:300,disable:!1,snap:!1},template:'\x3cdiv class\x3d"slider-container"\x3e\x3cdiv class\x3d"back-bar"\x3e\x3cdiv class\x3d"selected-bar"\x3e\x3c/div\x3e\x3cdiv class\x3d"pointer low"\x3e\x3c/div\x3e\x3cdiv class\x3d"pointer-label low"\x3e123456\x3c/div\x3e\x3cdiv class\x3d"pointer high"\x3e\x3c/div\x3e\x3cdiv class\x3d"pointer-label high"\x3e456789\x3c/div\x3e\x3cdiv class\x3d"clickable-dummy"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"scale"\x3e\x3c/div\x3e\x3c/div\x3e',
init:function(a,b){this.options=c.extend({},this.defaults,b);this.inputNode=c(a);this.options.value=this.inputNode.val()||(this.options.isRange?this.options.from+","+this.options.from:""+this.options.from);this.domNode=c(this.template);this.domNode.addClass(this.options.theme);this.inputNode.after(this.domNode);this.domNode.on("change",this.onChange);this.pointers=c(".pointer",this.domNode);this.lowPointer=this.pointers.first();this.highPointer=this.pointers.last();this.labels=c(".pointer-label",
this.domNode);this.lowLabel=this.labels.first();this.highLabel=this.labels.last();this.scale=c(".scale",this.domNode);this.bar=c(".selected-bar",this.domNode);this.clickableBar=this.domNode.find(".clickable-dummy");this.interval=this.options.to-this.options.from;this.render()},render:function(){0!==this.inputNode.width()||this.options.width?(this.options.width=this.options.width||this.inputNode.width(),this.domNode.width(this.options.width),this.inputNode.hide(),this.isSingle()&&(this.lowPointer.hide(),
this.lowLabel.hide()),this.options.showLabels||this.labels.hide(),this.attachEvents(),this.options.showScale&&this.renderScale(),this.setValue(this.options.value)):console.log("jRange : no width found, returning")},isSingle:function(){return"number"===typeof this.options.value?!0:-1!==this.options.value.indexOf(",")||this.options.isRange?!1:!0},attachEvents:function(){this.clickableBar.click(c.proxy(this.barClicked,this));this.pointers.on("mousedown touchstart",c.proxy(this.onDragStart,this));this.pointers.bind("dragstart",
function(a){a.preventDefault()})},onDragStart:function(a){this.options.disable||"mousedown"===a.type&&1!==a.which||(a.stopPropagation(),a.preventDefault(),a=c(a.target),this.pointers.removeClass("last-active"),a.addClass("focused last-active"),this[(a.hasClass("low")?"low":"high")+"Label"].addClass("focused"),c(k).on("mousemove.slider touchmove.slider",c.proxy(this.onDrag,this,a)),c(k).on("mouseup.slider touchend.slider touchcancel.slider",c.proxy(this.onDragEnd,this)))},onDrag:function(a,b){b.stopPropagation();
b.preventDefault();b.originalEvent.touches&&b.originalEvent.touches.length?b=b.originalEvent.touches[0]:b.originalEvent.changedTouches&&b.originalEvent.changedTouches.length&&(b=b.originalEvent.changedTouches[0]);b=b.clientX-this.domNode.offset().left;this.domNode.trigger("change",[this,a,b])},onDragEnd:function(a){this.pointers.removeClass("focused").trigger("rangeslideend");this.labels.removeClass("focused");c(k).off(".slider");this.options.ondragend.call(this,this.options.value)},barClicked:function(a){if(!this.options.disable){a=
a.pageX-this.clickableBar.offset().left;if(this.isSingle())this.setPosition(this.pointers.last(),a,!0,!0);else{var b=Math.abs(parseFloat(this.pointers.first().css("left"),10)),c=this.pointers.first().width()/2,e=Math.abs(parseFloat(this.pointers.last().css("left"),10)),d=this.pointers.first().width()/2,c=Math.abs(b-a+c),e=Math.abs(e-a+d),b=c==e?a<b?this.pointers.first():this.pointers.last():c<e?this.pointers.first():this.pointers.last();this.setPosition(b,a,!0,!0)}this.options.onbarclicked.call(this,
this.options.value)}},onChange:function(a,b,c,e){var d;a=0;d=b.domNode.width();b.isSingle()||(a=c.hasClass("high")?parseFloat(b.lowPointer.css("left"))+b.lowPointer.width()/2:0,d=c.hasClass("low")?parseFloat(b.highPointer.css("left"))+b.highPointer.width()/2:b.domNode.width());b.setPosition(c,Math.min(Math.max(e,a),d),!0)},setPosition:function(a,b,c,e){var d;d=parseFloat(this.lowPointer.css("left"));var f=parseFloat(this.highPointer.css("left"))||0,g=this.highPointer.width()/2;c||(b=this.prcToPx(b));
if(this.options.snap&&(b=this.correctPositionForSnap(b),-1===b))return;a[0]===this.highPointer[0]?f=Math.round(b-g):d=Math.round(b-g);a[e?"animate":"css"]({left:Math.round(b-g)});d=this.isSingle()?0:d+g;f=Math.round(f+g-d);this.bar[e?"animate":"css"]({width:Math.abs(f),left:0<f?d:d+f});this.showPointerValue(a,b,e);this.isReadonly()},correctPositionForSnap:function(a){var b=this.positionToValue(a)-this.options.from,c=this.options.width/(this.interval/this.options.step),b=b/this.options.step*c;return a<=
b+c/2&&a>=b-c/2?b:-1},setValue:function(a){var b=a.toString().split(",");b[0]=Math.min(Math.max(b[0],this.options.from),this.options.to)+"";1<b.length&&(b[1]=Math.min(Math.max(b[1],this.options.from),this.options.to)+"");this.options.value=a;a=this.valuesToPrc(2===b.length?b:[0,b[0]]);this.isSingle()||this.setPosition(this.lowPointer,a[0]);this.setPosition(this.highPointer,a[1])},renderScale:function(){for(var a=this.options.scale||[this.options.from,this.options.to],b=Math.round(100/(a.length-1)*
10)/10,f="",e=0;e<a.length;e++)f+='\x3cspan style\x3d"left: '+e*b+'%"\x3e'+("|"!=a[e]?"\x3cins\x3e"+a[e]+"\x3c/ins\x3e":"")+"\x3c/span\x3e";this.scale.html(f);c("ins",this.scale).each(function(){c(this).css({marginLeft:-c(this).outerWidth()/2})})},getBarWidth:function(){var a=this.options.value.split(",");return 1<a.length?parseFloat(a[1])-parseFloat(a[0]):parseFloat(a[0])},showPointerValue:function(a,b,f){var e=c(".pointer-label",this.domNode)[a.hasClass("low")?"first":"last"](),d,h=this.positionToValue(b);
c.isFunction(this.options.format)?(d=this.isSingle()?n:a.hasClass("low")?"low":"high",d=this.options.format(h,d)):d=this.options.format.replace("%s",h);var g=e.html(d).width();e[f?"animate":"css"]({left:Math.min(Math.max(b-g/2,0),this.options.width-g)});c(".text.txt_range1").length&&c(".text.txt_range2").length&&(a.hasClass("low")?c(".text.txt_range1").val(d):c(".text.txt_range2").val(d));this.setInputValue(a,h)},valuesToPrc:function(a){var b=100*(parseFloat(a[0])-parseFloat(this.options.from))/this.interval;
a=100*(parseFloat(a[1])-parseFloat(this.options.from))/this.interval;return[b,a]},prcToPx:function(a){return this.domNode.width()*a/100},isDecimal:function(){return-1===(this.options.value+this.options.from+this.options.to).indexOf(".")?!1:!0},positionToValue:function(a){a=a/this.domNode.width()*this.interval;a=parseFloat(a,10)+parseFloat(this.options.from,10);if(this.isDecimal()){a=Math.round(Math.round(a/this.options.step)*this.options.step*100)/100;if(0!==a)for(a=""+a,-1===a.indexOf(".")&&(a+=
".");3>a.length-a.indexOf(".");)a+="0";else a="0.00";return a}return Math.round(a/this.options.step)*this.options.step},setInputValue:function(a,b){if(this.isSingle())this.options.value=b.toString();else{var c=this.options.value.split(",");a.hasClass("low")?this.options.value=b+","+c[1]:this.options.value=c[0]+","+b}this.inputNode.val()!==this.options.value&&(this.inputNode.val(this.options.value).trigger("change"),this.options.onstatechange.call(this,this.options.value))},getValue:function(){return this.options.value},
getOptions:function(){return this.options},getRange:function(){return this.options.from+","+this.options.to},isReadonly:function(){this.domNode.toggleClass("slider-readonly",this.options.disable)},disable:function(){this.options.disable=!0;this.isReadonly()},enable:function(){this.options.disable=!1;this.isReadonly()},toggleDisable:function(){this.options.disable=!this.options.disable;this.isReadonly()},updateRange:function(a,b){a=a.toString().split(",");this.interval=parseInt(a[1])-parseInt(a[0]);
b?this.setValue(b):this.setValue(this.getValue())}};c.fn.jRange=function(a){var b=arguments,f;this.each(function(){var e=c(this),d=c.data(this,"plugin_jRange"),h="object"===typeof a&&a;d||(e.data("plugin_jRange",d=new l(this,h)),c(m).resize(function(){d.setValue(d.getValue())}));"string"===typeof a&&(f=d[a].apply(d,Array.prototype.slice.call(b,1)))});return f||this}})(jQuery,window,document);