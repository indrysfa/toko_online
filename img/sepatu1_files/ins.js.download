(function(){window.API_VERSION_ilotteidstaging='v2.7.2';})();function insIsLocalStorageSupported(){var insider='insider';try{localStorage.setItem(insider,insider);localStorage.removeItem(insider);return true;}catch(e){return false;}}
if(!insIsLocalStorageSupported()&&typeof console.log!=='undefined'){console.log('LocalStorage Support is not supported. API will not initialize.');}
else if(spApi===undefined){var spApi={};spApi.loadScript=function(url,callback){var script=document.createElement('script')
script.type='text/javascript';script.async='async';if(script.readyState){script.onreadystatechange=function(){if(script.readyState=='loaded'||script.readyState=='complete'){script.onreadystatechange=null;if('function'===typeof callback){callback();}}};}else{script.onload=function(){if('function'===typeof callback){callback();}};}
script.src=url;document.getElementsByTagName('head')[0].appendChild(script);};var sQuery;var protocol='';function insiderMain(){var NO_JQUERY={};(function(a,b,c){if(!("console"in a)){var d=a.console={};d.log=d.warn=d.error=d.debug=function(){}}if(b===NO_JQUERY){b={fn:{},extend:function(){var a=arguments[0];for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b];for(var e in d){a[e]=d[e]}}return a}}}b.fn.pm=function(){return this};b.pm=a.pm=function(a){e.send(a)};b.pm.bind=a.pm.bind=function(a,b,c,d,f){e.bind(a,b,c,d,f===true)};b.pm.unbind=a.pm.unbind=function(a,b){e.unbind(a,b)};b.pm.origin=a.pm.origin=null;b.pm.poll=a.pm.poll=200;var e={send:function(a){var c=b.extend({},e.defaults,a),d=c.target;if(!c.target){return}if(!c.type){return}var f={data:c.data,type:c.type};if(c.success){f.callback=e._callback(c.success)}if(c.error){f.errback=e._callback(c.error)}if("postMessage"in d&&!c.hash){e._bind();d.postMessage(sQuery.toJSON(f),c.origin||"*")}else{e.hash._bind();e.hash.send(c,f)}},bind:function(a,b,c,d,f){e._replyBind(a,b,c,d,f)},_replyBind:function(c,d,f,g,h){if("postMessage"in a&&!g){e._bind()}else{e.hash._bind()}var i=e.data("listeners.postmessage");if(!i){i={};e.data("listeners.postmessage",i)}var j=i[c];if(!j){j=[];i[c]=j}j.push({fn:d,callback:h,origin:f||b.pm.origin})},unbind:function(a,b){var c=e.data("listeners.postmessage");if(c){if(a){if(b){var d=c[a];if(d){var f=[];for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i.fn!==b){f.push(i)}}c[a]=f}}else{delete c[a]}}else{for(var g in c){delete c[g]}}}},data:function(a,b){if(b===c){return e._data[a]}e._data[a]=b;return b},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){var a=[];for(var b=0;b<32;b++){a[b]=e._CHARS[0|Math.random()*32]}return a.join("")},_callback:function(a){var b=e.data("callbacks.postmessage");if(!b){b={};e.data("callbacks.postmessage",b)}var c=e._random();b[c]=a;return c},_bind:function(){if(!e.data("listening.postmessage")){if(a.addEventListener){a.addEventListener("message",e._dispatch,false)}else if(a.attachEvent){a.attachEvent("onmessage",e._dispatch)}e.data("listening.postmessage",1)}},_dispatch:function(a){try{if(!a.data){return}var b=sQuery.evalJSON(a.data)}catch(c){return}if(!b.type){return}var d=e.data("callbacks.postmessage")||{},f=d[b.type];if(f){f(b.data)}else{var g=e.data("listeners.postmessage")||{};var h=g[b.type]||[];for(var i=0,j=h.length;i<j;i++){var k=h[i];if(k.origin&&k.origin!=="*"&&a.origin!==k.origin){if(b.errback){var l={message:"postmessage origin mismatch",origin:[a.origin,k.origin]};e.send({target:a.source,data:l,type:b.errback})}continue}function m(c){if(b.callback){e.send({target:a.source,data:c,type:b.callback})}}try{if(k.callback){k.fn(b.data,m,a)}else{m(k.fn(b.data,a))}}catch(c){if(b.errback){e.send({target:a.source,data:c,type:b.errback})}else{throw c}}}}}};e.hash={send:function(b,c){var d=b.target,f=b.url;if(!f){return}f=e.hash._url(f);var g,h=e.hash._url(a.location.href);if(a==d.parent){g="parent"}else{try{for(var i=0,j=parent.frames.length;i<j;i++){var k=parent.frames[i];if(k==a){g=i;break}}}catch(l){g=a.name}}if(g==null){return}var m={"x-requested-with":"postmessage",source:{name:g,url:h},postmessage:c};var n="#x-postmessage-id="+e._random();d.location=f+n+encodeURIComponent(sQuery.toJSON(m))},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:"#x-postmessage-id=".length+32,_bind:function(){if(!e.data("polling.postmessage")){setInterval(function(){var b=""+a.location.hash,c=e.hash._regex.exec(b);if(c){var d=c[1];if(e.hash._last!==d){e.hash._last=d;e.hash._dispatch(b.substring(e.hash._regex_len))}}},b.pm.poll||200);e.data("polling.postmessage",1)}},_dispatch:function(b){if(!b){return}try{b=sQuery.evalJSON(decodeURIComponent(b));if(!(b["x-requested-with"]==="postmessage"&&b.source&&b.source.name!=null&&b.source.url&&b.postmessage)){return}}catch(c){return}var d=b.postmessage,f=e.data("callbacks.postmessage")||{},g=f[d.type];if(g){g(d.data)}else{var h;if(b.source.name==="parent"){h=a.parent}else{h=a.frames[b.source.name]}var i=e.data("listeners.postmessage")||{};var j=i[d.type]||[];for(var k=0,l=j.length;k<l;k++){var m=j[k];if(m.origin){var n=/https?\:\/\/[^\/]*/.exec(b.source.url)[0];if(m.origin!=="*"&&n!==m.origin){if(d.errback){var o={message:"postmessage origin mismatch",origin:[n,m.origin]};e.send({target:h,data:o,type:d.errback,hash:true,url:b.source.url})}continue}}function p(a){if(d.callback){e.send({target:h,data:a,type:d.callback,hash:true,url:b.source.url})}}try{if(m.callback){m.fn(d.data,p)}else{p(m.fn(d.data))}}catch(c){if(d.errback){e.send({target:h,data:c,type:d.errback,hash:true,url:b.source.url})}else{throw c}}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}};b.extend(e,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:false}})})(this,typeof sQuery==="undefined"?NO_JQUERY:sQuery);(function(a){a.cookie=function(b,c,d){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(c))||c===null||c===undefined)){d=a.extend({},d);if(c===null||c===undefined){d.expires=-1}if(typeof d.expires==="number"){var e=d.expires,f=d.expires=new Date;f.setDate(f.getDate()+e)}c=String(c);return document.cookie=[encodeURIComponent(b),"=",d.raw?c:encodeURIComponent(c),d.expires?"; expires="+d.expires.toUTCString():"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",d.secure?"; secure":""].join("")}d=c||{};var g=d.raw?function(a){return a}:decodeURIComponent;var h=document.cookie.split("; ");for(var i=0,j;j="undefined"!==typeof h[i]&&h[i].split("=");i++){if(g(j[0])===b)return g(j[1]||"")}return null}})(sQuery);(function($){'use strict';var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON==='object'&&JSON.stringify?JSON.stringify:function(o){if(o===null){return'null';}var pairs,k,name,val,type=$.type(o);if(type==='undefined'){return undefined;}if(type==='number'||type==='boolean'){return String(o);}if(type==='string'){return $.quoteString(o);}if(typeof o.toJSON==='function'){return $.toJSON(o.toJSON());}if(type==='date'){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month='0'+month;}
if(day<10){day='0'+day;}if(hours<10){hours='0'+hours;}if(minutes<10){minutes='0'+minutes;}if(seconds<10){seconds='0'+seconds;}if(milli<100){milli='0'+milli;}if(milli<10){milli='0'+milli;}return'"'+year+'-'+month+'-'+day+'T'+
hours+':'+minutes+':'+seconds+'.'+milli+'Z"';}pairs=[];if($.isArray(o)){for(k=0;k<o.length;k++){pairs.push($.toJSON(o[k])||'null');}
return'['+pairs.join(',')+']';}if(typeof o==='object'){for(k in o){if(hasOwn.call(o,k)){type=typeof k;if(type==='number'){name='"'+k+'"';}else if(type==='string'){name=$.quoteString(k);}else{continue;}type=typeof o[k];if(type!=='function'&&type!=='undefined'){val=$.toJSON(o[k]);pairs.push(name+':'+val);}}}return'{'+pairs.join(',')+'}';}};$.evalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(str){return eval('('+str+')');};$.secureEvalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered)){return eval('('+str+')');}throw new SyntaxError('Error parsing JSON, source is not valid.');};$.quoteString=function(str){if(str.match(escape)){return'"'+str.replace(escape,function(a){var c=meta[a];if(typeof c==='string'){return c;}c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}return'"'+str+'"';};}(sQuery));partnerName="ilotteidstaging";partner_site={"scheme":"https","host":"ecstg.ilotte.com","path":"\/"};partner_site.host=partner_site.host.replace(/^www\./,'');var cookieDomain="."+partner_site.host;var isInIFrame=(window.location!=window.top.location);var panelEdit=false;if(isInIFrame==true){sQuery.cookie('ins-panel',1,{expires:1,path:'/',domain:'.'+partner_site.host});panelEdit=true;}
else{sQuery.cookie('ins-panel',null,{expires:-1,path:'/',domain:'.'+partner_site.host});}
if(typeof disabledEdit!='undefined'&&disabledEdit==true){panelEdit=false;}
function loadPanelView(){var js=undefined;var count=0;pm.bind('apiControl',function(){return'1';});if(panelEdit==true){var checkIframe=setInterval(function(){if(count==5&&js==undefined){clearInterval(checkIframe);window.panelEdit=false;panelEdit=false;spApi.init();return false;}
count++;pm({target:window.top,type:'checkIframe',data:{},success:function(result){if(typeof js==='object'){clearInterval(checkIframe);return false;}
var scriptSource=spApi.apiUrl+'edit/';var prototypeInterval=setInterval(function(){if(typeof Prototype!=='undefined'&&Prototype.Version<'1.7'&&Array.prototype.toJSON){delete Array.prototype.toJSON;delete Array.prototype.toArray;clearInterval(prototypeInterval);}},10);setTimeout(function(){if(typeof prototypeInterval!=='undefined'){clearInterval(prototypeInterval);}},3000);js=result;if(typeof js==='object'){window.ActionBuilderSettings=js.config;var appPath=result.config.app.appPath;if(typeof appPath=='undefined'){appPath=scriptSource+'actionbuilder/frame/app.js';}
var html_doc=document.getElementsByTagName('head')[0];var scriptElement=document.createElement('script');scriptElement.setAttribute('language','javascript');scriptElement.setAttribute('type','text/javascript');scriptElement.setAttribute('src',appPath+'?v='+spApi.genDate);html_doc.appendChild(scriptElement);clearInterval(checkIframe);}else{var scriptElement=document.createElement('script');scriptElement.type='text/javascript';scriptElement.src=scriptSource+js+'?'+new Date().getTime();document.getElementsByTagName('head')[0].appendChild(scriptElement);clearInterval(checkIframe);}}});},100);}}
sQuery(document).ready(function(){loadPanelView();});function getAnalytics(callback){esCountAnalytics(callback);}function esCountAnalytics(callback,campId){return;}
function parseAnalyticsData(e){}
function esLiveFeed(callback){return;function parsehistoryData(e){}
function parseCustomPlusData(e){}
function parseNotifyData(e){}}
protocol='https://';var _json_stringify=JSON.stringify;JSON.stringify=function(object,replacer,space){var Prototype=window.Prototype;if(typeof Prototype!=='undefined'&&Prototype.Version<'1.7'&&Array.prototype.toJSON&&Object.toJSON){return Object.toJSON(object)}
return _json_stringify(object,replacer,space);}
sQuery.fn.extend({exists:function(){return this.length>0;},elementLoadComplete:function(callback,customConfig,notFoundCallback){try{var defaults={t:spApi.elementLoadCompleteConfig.timeout,infinite:spApi.elementLoadCompleteConfig.infinite};var config=sQuery.extend(defaults,customConfig);var selector=this.selector;if(typeof selector!=='string'||typeof callback!=='function'){return false;}
if(sQuery(selector).exists()&&!config.infinite){return callback(sQuery(selector));}
if(config.type==='interval'){spApi.waitElementWithInterval({selector:selector,callback:callback,notFoundCallback:notFoundCallback,timeout:config.t});return false;}
var index=spApi.elementLoadCompleteConfig.mutableList.push({selector:selector,callback:callback,infinite:config.infinite,notFoundCallbackTimeout:setTimeout(function(){if(spApi.elementLoadCompleteConfig.mutableList[index-1]instanceof Object){spApi.elementLoadCompleteConfig.mutableList[index-1].invalid=true;}
if(typeof notFoundCallback==='function'){spApi.logger('warning','Selector not found.'+selector);notFoundCallback();}},config.t)});spApi.elementLoadCompleteConfig.mutationCallback=spApi.debounce(function(){var mutableList=spApi.elementLoadCompleteConfig.mutableList;mutableList.forEach(function(mutableObject,index){if(sQuery(mutableObject.selector).exists()&&typeof mutableObject.invalid==='undefined'){spApi.logger('info','Selector has been found, callback is running.'+mutableObject.selector);clearTimeout(mutableObject.notFoundCallbackTimeout);mutableObject.callback(sQuery(mutableObject.selector));if(!mutableObject.infinite){mutableList[index].invalid=false;}}});},50);if(spApi.elementLoadCompleteConfig.inited){return false;}
spApi.elementLoadCompleteConfig.inited=true;var referenceElement=document.body||document;if(window.MutationObserver&&referenceElement){setTimeout(function(){var observer=new MutationObserver(spApi.elementLoadCompleteConfig.mutationCallback);observer.observe(referenceElement,{childList:true,subtree:true});spApi.elementLoadCompleteConfig.disconnect=observer.disconnect.bind(observer);},0);}else{referenceElement.removeEventListener('DOMSubtreeModified',spApi.elementLoadCompleteConfig.mutationCallback);referenceElement.addEventListener('DOMSubtreeModified',spApi.elementLoadCompleteConfig.mutationCallback);}
if(spApi.elementLoadCompleteConfig.autoExpireActivated){setTimeout(spApi.clearElementLoadComplete,spApi.elementLoadCompleteConfig.timeout||(15*1000));}}catch(error){spApi.errLog(error,{logType:'ElementLoadComplete',bugType:'product'});}
return this;}});function setSessionOnlyCookie(cookieName,cookieValue){if(navigator.userAgent.indexOf('MSIE')!==-1||navigator.appVersion.indexOf('Trident/')>0){document.cookie=cookieName+"="+cookieValue+"; path=/";}else{document.cookie=cookieName+'='+cookieValue+';path=/'+';expires='+'0';}}
if(typeof spPanelPreview=="undefined"||spPanelPreview!=true){var disable_camp=false;}
else{var disable_camp=true;}
spApi={loadScript:spApi.loadScript,isAjaxAsync:false,viewedCustomCamps:[],Base64:{encode:function(str){return btoa(unescape(encodeURIComponent(str)));},decode:function(str){return decodeURIComponent(escape(atob(str)));}},consoleLog:[],salesSesId:'MA==',partnerTimeZone:'Europe/Istanbul',goalList:[],goalObserverStatus:false,goalLogs:[],dbLog:[],hitSend:false,errLogActive:true,esResultCheck:function(campId,logic,value,aggrName){return spApi.e("(this.gaDimensionQ['"+campId+"_"+aggrName+"'] "+logic+" "+value+")");},paaProducts:[32,39,47],isFirstVersus:false,highlight:function(element,options){return sQuery(element).highlight(options);},debounce:function(func,wait){var timeout;return function(){clearTimeout(timeout);timeout=setTimeout(func.bind(this),wait);};},isset:function(value){return typeof value!=='undefined'&&typeof value!=='unknown';},mask:sQuery.mask,gaDimensionQ:{},getBrowser:function(version,lowerCase){var ua=navigator.userAgent,tem,M=ua.match(/(yabrowser|opera|chrome|crios|safari|firefox|msie|edge|maxthon|trident|ubrowser|ucbrowser(?=\/))\/?\s*(\d+)/i)||[];var done=false;if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];M[0]='IE';M[1]=(tem[1]||-1);done=true;}else if(M[1]==='Chrome'){if(ua.match(/\b(Edge)\/(\d+)/)!=null){tem=ua.match(/\b(Edge)\/(\d+)/);done=true;M[0]='Edge';M[1]=(tem[2]||-1);}else if(ua.match(/\b(YaBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(YaBrowser)\/(\d+)/);done=true;M[0]='Yandex';M[1]=(tem[2]||-1);}else if(ua.match(/\b(OPR)\/(\d+)/)!=null){tem=ua.match(/\b(OPR)\/(\d+)/);done=true;M[0]='Opera';M[1]=(tem[2]||-1);}else if(ua.match(/\b(UBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(UBrowser)\/(\d+)/);done=true;M[0]='UCBrowser';M[1]=(tem[2]||-1);}else if(ua.match(/\b(SamsungBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(SamsungBrowser)\/(\d+)/);done=true;M[0]='Samsung Internet';M[1]=(tem[2]||-1);}}else if(ua.match(/\b(CriOS)\/(\d+)/)!=null){tem=ua.match(/\b(CriOS)\/(\d+)/);done=true;M[0]='Chrome';M[1]=(tem[2]||-1);}
if(ua.match(/\b(coc_coc_browser)\/(\d+)/)!=null||(navigator.vendor&&navigator.vendor=='Coc Coc')){tem=ua.match(/\b(coc_coc_browser)\/(\d+)/)||'';done=true;M[0]='CocCoc';M[1]=(tem[2]||-1);}
if(!done){M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,-1];if((tem=ua.match(/version\/(\d+)/i))!=null)
M.splice(1,1,tem[1]);}
if(typeof version!=='undefined'&&version)
return M[1]||-1;if(M[0]=='MSIE')M[0]='IE';if(typeof lowerCase!=='undefined'&&lowerCase)
M[0]=M[0].toLowerCase();return M[0];},conTrace:function(){if(spApi.debugModeIsOpen()&&typeof console.trace!=='undefined'){console.trace.apply(console,arguments);}},errLog:function(error,data){if(typeof data=="undefined"){data={logType:'Bilinmeyen Hata'};}
data.errorName=error.name;data.errorMessage=error.message;data.errorLineNumber=error.lineNumber||'';data.errorStack=error.stack||'';data.partnerName=partnerName;data.bugType=data.bugType||'product';data.url=window.location.href;data.host=window.location.host;data.referrer=window.document.referrer;data.date=new Date().getTime();data.browser=spApi.getBrowser();data.browserVersion=spApi.getBrowser(true);data.browserLang=navigator.language;data.platform=navigator.platform;data.userAgent=navigator.userAgent;if(typeof spApi.errLogs==='undefined'){spApi.errLogs=[];}
spApi.errLogs.push(data);spApi.conTrace(error,data);if(typeof spApi.consoleLog.push==='function'){spApi.consoleLog.push('ERROR',data);}
var validateIpAddress=function(ipAddress){var ipRegex=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;return ipRegex.test(ipAddress);};if(data.logType==='siteUrlCheckFailed'&&data.host.indexOf('local')<0&&data.host.indexOf('test')<0&&!validateIpAddress(data.host)){}},limitSystemRulesCall:function(){var systemRules=spApi.getPrototype('systemRules');var handler=function handler(fn,ruleName){if(spApi[ruleName].callLimit<500){spApi[ruleName].callLimit+=1;return fn.apply(this,arguments);}else{try{spApi[ruleName].callLimit=0;throw new Error();}catch(error){spApi.errLog(error,{logType:'Possible infinite loop on system rule call ('+ruleName+')',bugType:'System Rules'});}}};systemRules.forEach(function(ruleName){if(typeof spApi[ruleName]==='function'&&typeof spApi[ruleName].callLimit==='undefined'){spApi[ruleName]=handler.bind(this,spApi[ruleName],ruleName);spApi[ruleName].callLimit=0;}}.bind(this));},resetSystemRulesCallLimits:function(){spApi.logger('info','Resetting call limits for system rules');var systemRules=spApi.getPrototype('systemRules');systemRules.forEach(function(ruleName){(spApi[ruleName]||{}).callLimit=0;});},isBrowserSupportEnabled:function(){try{var browser=spApi.getBrowser();var version=Number(spApi.getBrowser(true));if(browser=="IE"&&version<=10){return false;}
return true;}
catch(e){spApi.errLog(e);}},isCookieSupportEnabled:function(){try{if(spApi.cookieSupport){return true;}
document.cookie="scs=1";if(sQuery.cookie("scs")){spApi.cookieSupport=true;return true;}
return false;}catch(e){spApi.errLog(e)}},bindAutoClose:function(campaign,callback){},isLocalStorageSupport:insIsLocalStorageSupported,getParameterFromUrl:function(url,parameter)
{var name=parameter.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);if(results==null)
return"";else
return decodeURIComponent(results[1]);},isOptOut:function(){return sQuery.cookie('INSOPTOUT')!==null;},optOutRequestExists:function(){return spApi.hasParameter('INSOPTOUT');},checkOptOut:function(){if(spApi.optOutRequestExists()&&!spApi.isOptOut()){spApi.worker.asyncPM('insOptOut');sQuery.cookie('INSOPTOUT',1,{expires:360,path:'/',domain:cookieDomain});}
return spApi.isOptOut();},resetAddCartCount:function(){var counter=[];localStorage.setItem('addCartCount',counter);},loaded:false,showActiveCamp:function(){spApi.activeCamp=spApi.getCampOfThePage(spApi.camps);if(spApi.activeCamp){try{var selectedElement=typeof spApi.notifies[spApi.activeCamp.id]==='undefined'?'':spApi.notifies[spApi.activeCamp.id].locationConfig.selectedElement;if(typeof spApi.notifies[spApi.activeCamp.id]!=='undefined'){var locationConfig=spApi.notifies[spApi.activeCamp.id].locationConfig;if(locationConfig.selectedElement){selectedElement=locationConfig.selectedElement;}else if(locationConfig.relativePositioning==='true'&&locationConfig.relativePosition.element){selectedElement=locationConfig.relativePosition.element;}}
var activeCampId=spApi.activeCamp.id;if(spApi.isControlCamp(activeCampId)){selectedElement=spApi.getControlGroupSelectedElement(activeCampId);}
if(selectedElement){sQuery(selectedElement).elementLoadComplete(function(){spApi.showCamp(spApi.activeCamp);},{t:1000},function(){(spApi.getCamp(activeCampId).camp||{}).invalid=true;spApi.logger('info','Campaign reference element not found, next campaign will be showed',activeCampId);spApi.showActiveCamp();});}else{spApi.showCamp(spApi.activeCamp);}}catch(error){spApi.errLog(error);}}},isBannerManagementActive:function(){return typeof spApi.bannerManagementCamps!=='undefined'&&spApi.bannerManagementCamps.length>0;},showCustomCamp:function(customCamp){},clearCustomCamps:function(){},initCustomCamps:function(){},setCampSalesSesId:function(){if(spApi.salesSesId==false){spApi.errLog({name:'Error',message:'salesSessionIdNotExists'},{logType:'salesSesId',bugType:'product',extraData:{salesSesId:spApi.salesSesId}});return;}
var currentCookie='';try{var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;var value=obj.value;if(key.indexOf("sp-camp-")!=-1){currentCookie=obj;if(typeof value!=="undefined"){var campId=(key.replace('sp-camp-','')).replace(/^\s+|\s+$/gm,'');var objData=JSON.parse(unescape(value));var sesExpireTime=30*60;if(value.indexOf("salesSesId")==-1){objData.salesSesId=spApi.Base64.decode(spApi.salesSesId);objData.salesSesTime=spApi.getTime();var data={key:'sp-camp-'+campId,obj:objData,campId:campId};spApi.updateCookie(data,'nolog');}else if((parseInt(objData.salesSesTime)+sesExpireTime)>=spApi.getTime()&&objData.salesSesId==spApi.Base64.decode(spApi.salesSesId)){objData.salesSesTime=spApi.getTime();var data={key:'sp-camp-'+campId,obj:objData,campId:campId};spApi.updateCookie(data,'nolog');}}}});}catch(err){spApi.errLog(err,{logType:'setCampSalesSesId',bugType:'product',extraData:{Cookie:currentCookie,salesSesId:spApi.salesSesId}});}},storeLog:function(table,logData){spApi.worker.asyncPM('storeLog',{table:spApi.getLogTableAlias(table),logData:logData});},removePageOpacity:function(){if(typeof window['insPageShow']==='function'){window['insPageShow']();}},getDataFromDataLayer:function(property,additionalCondition,fallback){var fb=typeof fallback!=='undefined'?fallback:'';var checkCondition=(typeof additionalCondition!=='undefined'&&typeof additionalCondition==='function')?additionalCondition:function(){return true;};return((typeof dataLayer!=='undefined'?dataLayer:[]).filter(function(index){return typeof index[property]!=='undefined'&&checkCondition(index);})[0]||{})[property]||fb;},getDataFromIO:function(type,property,fallback){var fb=typeof fallback!=='undefined'?fallback:'';return(typeof insider_object!=='undefined'&&typeof insider_object[type]!=='undefined'&&typeof insider_object[type][property]!=='undefined')?insider_object[type][property]:fb;},generateProductId:function(parameter){var id=(parameter||location.href).toString().replace(/(<=&|\?)utm_.*/g,'').replace(location.origin,'');var idHash=spApi.hashCode(id.toString()).toString();var idBase64=spApi.Base64.encode(id);return'ins'+idHash+idBase64.substring(idBase64.length-(29-idHash.length));},pluralForm:{get:function(lang,count,form1,form2,form3,form4){if(typeof spApi.pluralForm[lang]==='undefined'){return form1;}
return spApi.pluralForm[lang](count,form1,form2,form3,form4);},en_US:function(count,form1,form2){return Math.abs(count)==1?form1:form2;},},translations:{"en_US":{"date":{"form1":{"day":"Day","hour":"Hour","minute":"Minute","second":"Second"},"form2":{"day":"Days","hour":"Hours","minute":"Minutes","second":"Seconds"}}}},isSiteUrlCheckFailed:function(){if(typeof spApi.isSiteUrlFailedLogSent!=='undefined'){return true;}
if(partnerName==='loadactionbuilder'&&spApi.isOnPanel()){return false;}
if(window.location.href.indexOf(partner_site.host)<0){spApi.logger('warning','Check your site information!');disable_camp=true;spApi.isSiteUrlFailedLogSent=true;spApi.errLog({name:'siteUrlCheckFailed'},{logType:'siteUrlCheckFailed',bugType:'partner',extraData:{partnerSiteHost:partner_site.host,scriptUrl:spApi.apiUrl}});return true;}
return false;},inited:false,init:function(noLog){try{spApi.worker.initializeUserId();if(!panelEdit){spApi.limitSystemRulesCall();}
if(spApi.checkOptOut()){spApi.logger('info','Opt Out');return false;}
spApi.logger('info','Insider API initializing..');if(!spApi.isBrowserSupportEnabled()){return false;}
if(!spApi.isLocalStorageSupport()){spApi.logger('info','LocalStorage Support Disabled...');return false;}
if(spApi.isSiteUrlCheckFailed()){return false;}
if(!spApi.isCookieSupportEnabled()){spApi.logger('info','Cookie Support Disabled...');return false;}
if(panelEdit===true){return false;}
if(spApi.localStorageGet('inLanding')==null)
spApi.storageData('inLanding',window.location.href,{path:'/',domain:cookieDomain});spApi.bounceCamp=undefined;spApi.activeCamps=[];spApi.activeWebPushes=[];spApi.activeConversionPushes={'set':[],'update':[],reset:[]};spApi.conditionCheckList=[];spApi.campCallbacks=[];spApi.userBounced=false;spApi.setAddCartCountFired=false;window.spPageVisitCount=undefined;window.esFeedData=undefined;if(noLog!==undefined){spApi.baseInit(noLog);}
else if(spApi.inited===false){function checkClickCapturingClasses(classList){return typeof classList==='string'&&(classList.indexOf('ins-category-sorting')>-1||classList.indexOf('sp-custom-')>-1||classList.indexOf('sp-goal-')>-1||classList.indexOf('insdr-insight-')>-1||classList.indexOf('ins-init-condition-tracking')>-1);}
document.addEventListener('click',function(event){for(var element=event.target;element;){var classes=element.className;if(checkClickCapturingClasses(classes)){sQuery(document).trigger('clickedElement',element);}
element=element.parentElement;}},!0);}
if(spApi.customizationCamps.length===0){spApi.removePageOpacity();}
function completed(){document.removeEventListener('DOMContentLoaded',completed);window.removeEventListener('load',completed);sQuery.ready();}
if(document.readyState==='complete'||(document.readyState!=='loading'&&!document.documentElement.doScroll)){window.setTimeout(sQuery.ready);}else{document.addEventListener('DOMContentLoaded',completed);window.addEventListener('load',completed);}
sQuery(document).ready(function(){if(spApi.inited===true)return false;spApi.inited=true;setTimeout(function(){spApi.baseInit(noLog);},0);});}catch(err){spApi.errLog(err,{logType:'init',bugType:'product',extraData:{param1:noLog}});}},shouldInitializeWebPush:function(){return typeof spApi.getWebPushOfThePage==='function'&&spApi.isWebPushInitialized!==true&&spApi.getBrowser()!=='Safari';},loadNotificationCenter:function(){},baseInit:function(noLog){try{window.sendEsReq=true;if(typeof noLog==='undefined')
window.noLog=true;else
window.noLog=noLog
spApi.couponAsistanceShow=function(callback){if(typeof callback!="undefined"){if(!Boolean(spApi.couponAsistanceShowEvents))
spApi.couponAsistanceShowEvents=[];spApi.couponAsistanceShowEvents.push(callback);}
return this;}
if(typeof spApi.setCustomSegments==='function'){spApi.setCustomSegments(spApi.customSegments);}
spApi.storageData(spApi.Base64.decode('aW5zR1VJRA=='),null);spApi.storageData(spApi.Base64.decode('c3BVSURHbG9iYWw='),null);spApi.triggerCartButton();spApi.initCustomCamps();spApi.getGAStyleSesId();if(spApi.isOnCartPage())
{var initialCartAmount=spApi.getTotalCartAmount()||0;var checkAndUpdateCartCookie=function(){var changedCartAmount=spApi.getTotalCartAmount()||0;var compareWithCookie=changedCartAmount!=parseFloat(sQuery.cookie('total-cart-amount')||'0');if((initialCartAmount!=changedCartAmount||compareWithCookie)&&spApi.isOnCartPage()){spApi.updateCartCookies();initialCartAmount=changedCartAmount;sQuery(document).trigger('cartAmountUpdated');if(typeof spApi.cartAbandonmentEmail==='object'){for(var provider in spApi.emailProviders){if(spApi.emailProviders.hasOwnProperty(provider)&&spApi.emailProviders[provider]===true){spApi.cartAbandonmentEmail.set(provider);}}}
spApi.conLog("Cart parameters have changed, updating...");spApi.conLog("Updated cart amount is: "+changedCartAmount);}};checkAndUpdateCartCookie();spApi.cartInterval=setInterval(checkAndUpdateCartCookie,1000);var pProd=spApi.getPaidProducts();var encodedProducts=JSON.stringify(pProd);var date=new Date();var minutes=30;date.setTime(date.getTime()+(minutes*60*1000));spApi.storageData('paid-products',encodedProducts,{expires:date,path:'/',domain:cookieDomain});spApi.updateCartCount(spApi.getCartCount());}
spApi.loadNotificationCenter();spApi.showActiveCamp();if(typeof spApi.getInsightOfThePage=='function'){spApi.getInsightOfThePage();}
if(spApi.shouldInitializeWebPush()){spApi.getWebPushOfThePage();}
spApi.noteTimer();spApi.setCouponAsistant();if(spApi.isOnAfterPaymentPage()){spApi.resetAddCartCount();}
if(spApi.isOnCartPage()){total=spApi.getTotalCartAmount();sQuery.cookie('total-cart-amount',total,{expires:1,path:'/',domain:cookieDomain});}
if(spApi.isOnAfterPaymentPage()){spApi.setSaLog();}
if(spApi.isOnProductPage()){sQuery.cookie('ins-product-id',(spApi.getCurrentProduct()||{}).id,{expires:365,path:'/',domain:'.'+partner_site.host});}
if(spApi.isOnProductPage()||spApi.isOnCartPage()){sQuery.cookie('current-currency',spApi.getCurrency(),{expires:1,path:'/',domain:cookieDomain});}}catch(err){spApi.errLog(err,{logType:'baseInit',bugType:'partner',extraData:{noLog:noLog}});}},sendAdAudience:function(camp){if(camp.productType!=32&&camp.productType!=39&&camp.productType!=47){return;}
var roiProofGroup='';var configuration={callback:'fbSend',callbackParams:{campId:camp.id},cookieType:'facebookAds',logMessage:'For this facebook ads campaign fbsend operation already executed. LS Info: '};if(camp.productType==32){configuration={callback:'gaSend',callbackParams:{type:'sendAdAudience',campId:camp.id},cookieType:'adaudience',logMessage:'For this Google Adwords campaign gaSend operation already executed. LS Info: '};}
var checkAudienceStatus=JSON.parse(spApi.storageData('sp-camp-'+camp.id));if(checkAudienceStatus){spApi.logger('warning',configuration.logMessage+JSON.stringify(checkAudienceStatus),camp.id);}else{var adAudienceLSData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id,table:'campLogs'};if(roiProofGroup){adAudienceLSData.obj.paaRoiSalesLogType=roiProofGroup==='ins-roi-experiment-impression'?'ins-roi-experiment-sale':'ins-roi-control-sale';}
spApi.updateCookie(adAudienceLSData,configuration.cookieType);if(roiProofGroup!=='ins-roi-control-impression'){spApi[configuration.callback](configuration.callbackParams);}}},facebookMessenger:{campaigns:[],userRef:Math.random().toString(36).substr(2),apiVersion:'v3.2',appId:'226371781276170'},personalizationSetStatus:false,preferredCurrency:"",supportedCurrencies:[],shownCampLimit:{"status":0,"maxCount":3,"timeSpan":1},genDate:1575301356,apiUrl:protocol+"ilotteidstaging.api.useinsider.com/",staticUrl:protocol+"static.api.useinsider.com/",frameUrl:"https://ilotteidstaging.api.useinsider.com/frame.php",target:sQuery("#partnerTarget"),camps:[],campaignTriggerManager:{},journeyAttributeList:[],insights:[],webPushes:[],whatsAppCampaigns:[],notificationCenterCamps:[],customSegments:[],personalizationCamps:[],rules:[],notifies:[],customizationCamps:[],bannerManagementCamps:[],journeyCamps:[],journeySegments:[],activeBannerManagementCamps:[],showedBMCampOfPage:[],gaCustomVar:1,gaIsActiveCustom:0,gaServiceIsActive:0,gaNonInteraction:1,userSegments:{},gaDataLayerIsActive:0,gaDataLayerSettings:false,ajsData:{},bounceExcludeList:[""],bounceExcludeLeft:-1,bounceExcludeRight:75,defaultVelocity:200,lang:[],spLang:'',conditionCheckList:[],campCallbacks:[],userBounced:false,setAddCartCountFired:false,logsStack:{},_bindedEvents:{},coeff:{"ecommerce":true,"v":null,"i":null,"t":null,"tMobile":null,"f":{}},customUserAttributes:[],productAttributes:[],crmAttributes:{},engageActionList:[],customChannelsTag:[],adwordsApiTags:[],siteUrl:'https://ecstg.ilotte.com/',listenerApiUrl:'https://listener.api.useinsider.com/v1/',urlParamSep:1,decryptCampName:function(campName){if(campName.indexOf('|-x-|')===0){return decodeURIComponent(window.atob(campName.substring(5)));}
return campName;},loadFramelessScripts:function(scripts){var scriptVersions={'insCountdown.min.js':'?v=1.0.3','insAnimation.min.js':'?v=1.0.1','webStory.min.js':'?v=1.0.4','inStory.min.js':'?v=1.1.3','jquery-ui.js':'?v=1.0.0'};var _arr=sQuery.map(scripts,function(script){var version=scriptVersions[script]||'';return sQuery.ajax({dataType:'script',cache:true,url:spApi.staticUrl+'js/libraries/'+script+version});});_arr.push(sQuery.Deferred(function(deferred){sQuery(deferred.resolve);}));return sQuery.when.apply(sQuery,_arr);},loadJsonFile:function(fileName,callback){try{var callbackName='jsonpCallback'+(Math.random().toString(16)+'000000000').substr(2,8);this[callbackName]=function(){};sQuery.ajax({url:spApi.apiUrl+'ajax.php?t=getJSONFile',data:{file:fileName,callback:callbackName},contentType:'application/json',dataType:'jsonp',jsonpCallback:callbackName,success:function(data){if(typeof callback==='function'){callback(data);}}});}catch(err){spApi.errLog(err,{logType:'Load Frameless Json File Error',bugType:'product',extraData:{'function':'loadFramlessJsonFile'}});}},postMessageEventIsValid:function(event){return/.api.useinsider.com$/.test(event.origin);},getUrl:function(){return window.location.href;},getAllCamps:function(){return spApi.getPrototype('allCamps');},getLogTableAlias:function(tableName){return spApi.getPrototype('logTables')[tableName];},allStorageData:function(){var pairs=[];try{var allData={};for(var i=0;i<window.localStorage.length;i++){var dataKey=window.localStorage.key(i);allData[dataKey]=window.localStorage.getItem(dataKey);}
sQuery.each(allData,function(key,val){try{var obj=JSON.parse(val);if(typeof obj.data==='object'){obj.data=JSON.stringify(obj.data);}
if(typeof obj['_expires']!=='undefined'&&obj['_expires']>Date.now()){pairs.push({'key':key,'value':obj['data']});}}
catch(e){pairs.push({'key':key,'value':val});}});}catch(err){spApi.errLog(err,{logType:'All Storage Data Error',bugType:'partner',extraData:{'function':'storageData'}});}
return pairs;},storageData:function(name,content,expireDate,callback){try{content=content!=null&&typeof content==='object'?JSON.stringify(content):content;if(typeof content==='undefined'){var currDate=new Date().getTime();var storageContent=spApi.localStorageGet(name);try{storageContent=JSON.parse(storageContent);if(typeof storageContent.data==='object'){storageContent.data=JSON.stringify(storageContent.data);}
if(storageContent!=null&&storageContent._expires>currDate){return storageContent.data;}else{var obj={action:'delete',name:name};spApi.worker.asyncPM('storageData',obj,callback);localStorage.removeItem(name);return null;}}
catch(e){return storageContent;}}else if(content==null){var obj={action:'delete',name:name};spApi.worker.asyncPM('storageData',obj,callback);localStorage.removeItem(name);return null;}else{var expires=typeof expireDate!=='undefined'?expireDate.expires:1;if(typeof expires==='object'){expires=expires.getTime();}else{var dateObj=new Date().getTime();dateObj+=1000*60*60*24*Number(expires)+10000;expires=dateObj;}
var stObj=new Object();stObj.data=typeof content==='object'?JSON.stringify(content):content;stObj._expires=expires;spApi.localStorageSet(sQuery.trim(name),JSON.stringify(stObj));if(typeof window.insdrSV==='undefined'){var version=sQuery.cookie('insdrSV')!=null?Number(sQuery.cookie('insdrSV')):0;version++;spApi.localStorageSet('insdrSV',version);sQuery.cookie('insdrSV',version,{expires:365,path:'/',domain:cookieDomain});window.insdrSV=version;}
var obj={action:'write',name:name,content:JSON.stringify(stObj)};spApi.worker.asyncPM('storageData',obj,callback);}}catch(err){spApi.errLog(err,{logType:'Data Storage Error',bugType:'partner',extraData:{'function':'storageData'}});}},_systemRuleError:function(name,func,err){var errLogStr=JSON.stringify(spApi.errLogs)||'';if(errLogStr.indexOf('"ruleName":"'+name+'"')!=-1)return;spApi.errLog(err,{logType:'System Rule Error',bugType:'partner',extraData:{ruleName:name,ruleContent:func.toString()}});},getPaidProducts:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getPaidProducts',funcString,err);}},getCurrentProduct:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCurrentProduct',funcString,err);}},getTotalCartAmount:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getTotalCartAmount',funcString,err);}},isOnCartPage:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCartPage',funcString,err);}},isOnAfterPaymentPage:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnAfterPaymentPage',funcString,err);}},isOnProductPage:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnProductPage',funcString,err);}},getProductCategories:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getProductCategories',funcString,err);}},spAddToCart:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('spAddToCart',funcString,err);}},getOrderId:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getOrderId',funcString,err);}},getLang:function(lang){try{var funcString="(function(){\nreturn\"tr_TR\";})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getLang',funcString,err);}},useCouponButton:function(){try{var funcString="(function(){\nvar useCouponButton=new Object();useCouponButton.button=\"\";useCouponButton.buttonClick=\"\";useCouponButton.couponInputText=\"\";useCouponButton.couponInput=\"\";return useCouponButton})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('useCouponButton',funcString,err);}},isUserLoggedIn:function(){try{var funcString="(function(){\nreturn false})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isUserLoggedIn',funcString,err);}},isOnRegSuccessPage:function(){try{var funcString="(function(){\nreturn false})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnRegSuccessPage',funcString,err);}},getSearchKeyWords:function(){try{var funcString="(function(){\nreturn\"\";})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getSearchKeyWords',funcString,err);}},isOnMainPage:function(){try{var funcString="(function(){\nreturn window.location.pathname==='\/';})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnMainPage',funcString,err);}},isOnCouponPage:function(){try{var funcString="(function(){\nreturn spApi.hasParameter('cart');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCouponPage',funcString,err);}},isOnCategoryPage:function(){try{var funcString="(function(){\nreturn false;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCategoryPage',funcString,err);}},getCategories:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCategories',funcString,err);}},setEmailToCookie:function(){try{var funcString="(function(){\nreturn false;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('setEmailToCookie',funcString,err);}},sliderSettings:function(){try{var funcString="(function(){\nreturn{isElementInSlider:function(element){return false;},getImageList:function(){var imageList=[];return imageList;},triggerClick:function(){var clickSelector='#rev_slider_1_1 .slidelink a';spApi.cstmClickHandler(clickSelector);},changeSlider:function(slide,order,logClass){if(logClass!=undefined){}}}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('sliderSettings',funcString,err);}},getCurrency:function(){try{var funcString="(function(){\nreturn\"\";})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCurrency',funcString,err);}},triggerCartButton:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('triggerCartButton',funcString,err);}},getCartCount:function(){try{var funcString="(function(){\nreturn 0;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCartCount',funcString,err);}},categorySettings:function(){try{var funcString="(function(){\nreturn{getCategoryList:function(){var categoryList=[];return categoryList;},triggerClick:function(){spApi.categoryClickHandler(\"#menu ul.navbar-nav > li > a\");},changeCategory:function(category,fromIndex,toIndex,logClass){if(fromIndex>toIndex){}else{}\nif(logClass!=undefined){}},getElementCategoryText:function(element){return sQuery(element).text();}}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('categorySettings',funcString,err);}},getLocale:function(){try{var funcString="(function(){\nreturn spApi.getLang();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getLocale',funcString,err);}},setCouponAsistant:function(couponSet,fromPurcha){},setProductCategory:function(){try{var currentProduct=spApi.getCurrentProduct();var category=sQuery.map(spApi.getProductCategories(),function(val,index){var str=val;return str;}).join("|");var p={cat:category,name:currentProduct.name,id:currentProduct.id};var encoded=spApi.storageData('prodCats');var prodCats=[];if(encoded){prodCats=JSON.parse(encoded);}
for(i in prodCats){if(prodCats[i].name==p.name){prodCats.splice(i,1);}}
prodCats.push(p);spApi.storageData('prodCats',sQuery.toJSON(prodCats),{expires:1,path:'/',domain:cookieDomain});}
catch(err){spApi.errLog(err,{logType:'setProductCategory',bugType:'product'});}},spRefId:"_spRefCode",urlencode:function(str){str=(str+'').toString();return encodeURIComponent(str).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/%20/g,'+');},getAppliedCode:function(campId){var couponCode='';var cookieData=JSON.parse(sQuery.cookie('sp-noteTimer'));if(cookieData!=null&&cookieData['cId']!=undefined&&cookieData['cId']==campId){if(cookieData['code']!=undefined&&cookieData['couponApply']!=undefined&&cookieData['couponApply']=='applied'){if(cookieData['encoded']!=undefined&&cookieData['encoded']=='true'){couponCode=spApi.Base64.decode(cookieData['code']);}else{couponCode=cookieData['code'];}}}
return couponCode;},updateTotalCartAmount:function(price,increase){var totalAmount=Number(sQuery.cookie('total-cart-amount'))||0;sQuery.cookie('total-cart-amount',increase?(totalAmount+Number(price)):(totalAmount-Number(price)>0?(totalAmount-Number(price)):0),{expires:1,path:'/',domain:partner_site.host});sQuery(document).trigger('cartAmountUpdated');},storeCartProductStorage:function(productList){var cartProductsStorageName='ins-cart-product-list';var twelveHoursAsMilliSeconds=60*60*12*1000;var date=new Date();date.setTime(date.getTime()+twelveHoursAsMilliSeconds);spApi.storageData(cartProductsStorageName,productList,{expires:date,domain:cookieDomain,path:'/'});},getCartProductStorage:function(){return spApi.cachedProductList||((sQuery.parseJSON(spApi.storageData('ins-cart-product-list'))||{}).productList)||[];},storeCartProductInformation:function(productInformation,quantityConfig){if(typeof productInformation==='undefined'&&productInformation.id===undefined){return;}
var cartProductsStorageName='ins-cart-product-list';var currentProductList=JSON.parse(spApi.storageData(cartProductsStorageName)||'{"totalQuantity": 0, "productList": []}');productInformation.quantity=productInformation.quantity||1;function adjustQuantityOfProduct(){var existingProduct=findMatchingProduct();if(Object.keys(existingProduct).length>0){if(typeof quantityConfig.increase!=='undefined'&&quantityConfig.increase){existingProduct.quantity+=Number(quantityConfig.count);productInformation=existingProduct;}else if(existingProduct.quantity>0&&typeof quantityConfig.increase!=='undefined'&&!quantityConfig.increase){existingProduct.quantity-=Number(quantityConfig.count);productInformation=existingProduct;}}}
function findMatchingProduct(){var foundProduct={};currentProductList.productList.map(function(product){if(product.id!==undefined&&product.id===productInformation.id){foundProduct=product;}});return foundProduct;}
function setTotalQuantity(){var totalQuantity=0;currentProductList.productList.forEach(function(product){if(product.id!==undefined){totalQuantity+=product.quantity;}});currentProductList.totalQuantity=totalQuantity;}
adjustQuantityOfProduct();if(Object.keys(findMatchingProduct()).length===0){currentProductList.productList.push(productInformation);}
setTotalQuantity();spApi.storeCartProductStorage(currentProductList);sQuery(document).trigger('changingCartCount');},updateCartCount:function(count){var cartProductsStorageName='ins-cart-product-list';var currentCartProductList=JSON.parse(spApi.storageData(cartProductsStorageName)||'{}');currentCartProductList.totalQuantity=count;currentCartProductList.productList=spApi.getPaidProducts();spApi.storeCartProductStorage(currentCartProductList);sQuery(document).trigger('cartAmountUpdated');},updateCartCookies:function(){var pProd=spApi.getPaidProducts();var date=new Date();date.setTime(date.getTime()+(30*60*1000));spApi.storageData('paid-products',JSON.stringify(pProd),{expires:date,path:'/',domain:cookieDomain});sQuery.cookie('total-cart-amount',spApi.getTotalCartAmount(),{expires:1,path:'/',domain:cookieDomain});sQuery.cookie('current-currency',spApi.getCurrency(),{expires:1,path:'/',domain:cookieDomain});},stringToCurrency:function(currency){try{currency=currency.replace(/^\s+|\s+$/g,'').toUpperCase();var search=['TL','YTL','€','EURO','$','DÓLAR','£','₽','руб','НАТИРАТЬ','₺','EU','US','ZŁ','¥','ЕУР'];var change=['TRY','TRY','EUR','EUR','USD','USD','GBP','RUB','RUB','RUB','TRY','EUR','USD','PLN','JPY','RSD'];sQuery.each(search,function(key,value){currency=(search[key]==currency)?currency.replace(search[key],change[key]):currency;});return currency;}catch(err){spApi.errLog(err);}},setExchangeRate:function(fromCurrency,toCurrency,price){try{if(fromCurrency!=toCurrency&&fromCurrency!=''&&toCurrency!=''){price=(price!=null&&typeof(price)!="number")?price.replace(/[^0-9.,]/g,''):price;if(typeof spApi.webPushUtilities==='object'){spApi.webPushUtilities.unconvertedCurrentPrice=price;}
if(price!=null&&!isNaN(price)){if(spApi.supportedCurrencies[fromCurrency]!=undefined){if(spApi.supportedCurrencies[fromCurrency][toCurrency]!=undefined)
return(Math.round(spApi.supportedCurrencies[fromCurrency][toCurrency]*price*1000)/1000);}
if(spApi.supportedCurrencies[toCurrency]!=undefined){if(spApi.supportedCurrencies[toCurrency][fromCurrency]!=undefined)
return(Math.round((1/spApi.supportedCurrencies[toCurrency][fromCurrency])*price*1000)/1000);}}}
return price;}catch(err){spApi.errLog(err);}},getExchangeRate:function(fromCurrency,toCurrency,data,element){var checkAndSetExchangeRate=function(data,element,index){var baseObject=data;if(typeof index!=='undefined'){baseObject=data[index];}
if(element==='price'){baseObject['notConvertedPrice']=baseObject[element];}
baseObject[element]=spApi.setExchangeRate(fromCurrency,toCurrency,baseObject[element]);return baseObject};try{switch(typeof data){case'number':var convertedPrice=spApi.setExchangeRate(fromCurrency,toCurrency,data);break;case'string':var convertedPrice=(isNaN(data))?data:spApi.setExchangeRate(fromCurrency,toCurrency,parseFloat(data));break;case'object':if(data!=null){if(data.length===undefined){if(data.hasOwnProperty(element)){data=checkAndSetExchangeRate(data,element);}else if(element instanceof Array){element.forEach(function(element){data=checkAndSetExchangeRate(data,element);});}}else{for(var i=0;i<data.length;i++){if(data[i].hasOwnProperty(element)){data[i]=checkAndSetExchangeRate(data,element,i);}else if(element instanceof Array){element.forEach(function(element){data[i]=checkAndSetExchangeRate(data,element,i);});}}}}
var convertedPrice=data;break;default:var convertedPrice=data;}
return convertedPrice;}catch(err){spApi.errLog(err);}},writeConsoleLog:function(){try{if(typeof spApi.consoleLog==='object'){sQuery(spApi.consoleLog).each(function(id,text){spApi.logger('info',text);});}}catch(err){spApi.errLog(err,{logType:'writeConsoleLog',bugType:'product'});}},getCampSalesSesInfo:function(campId,objType,productType){try{campId=((productType=='20')&&(campId.toString().indexOf('c')==-1))?'c'+campId:campId;var cmp=spApi.storageData('sp-camp-'+campId);if(cmp==null||cmp==undefined){return'0';}else{var obj=JSON.parse(cmp);return(obj[objType]==undefined)?'0':obj[objType];}}catch(err){spApi.errLog(err);}},getBuilderIdFromVar:function(campId)
{var segments=JSON.parse(spApi.storageData('user-segments'));for(var i in segments){if(segments[i]==campId)return i;}
return false;},getVariationsByBuilderId:function(builderId){return(spApi.personalizationCamps[builderId]||{}).variations||[];},getCampaignRatio:function(variationId){var builderId=spApi.getBuilderIdFromVar(variationId);return spApi.getVariationsByBuilderId(builderId).reduce(function(variation){if(variation.varId===variationId){return variation.ratio;}
return false;});},getControlGroupSelectedElement:function(controlVarId){var firstVariationId=spApi.getFirstVariationIdOfBuilder(controlVarId);var locationConfig=spApi.notifies[firstVariationId].locationConfig;return locationConfig.selectedElement||(locationConfig.relativePosition||{}).element;},getFirstVariationIdOfBuilder:function(variationId){var builderId=spApi.getBuilderIdFromVar(variationId);return spApi.personalizationCamps[builderId].variations[0].varId;},getBuilderIdFromPersonalizations:function(campId)
{var builderID=false;sQuery.each(spApi.personalizationCamps,function(id,personalization){sQuery.each(personalization.variations,function(key,variation){if(variation.varId==campId){builderID=id;return false;}});if(builderID){return false;}});return builderID;},e:function(js)
{return eval(js);},concat:function(camps,objects)
{sQuery.each(objects,function(i,obj){camps.push(obj);});return camps;},isCurrentCampBM:function(builderID){return sQuery.grep(spApi.bannerManagementCamps,function(camp){return camp.builderID==builderID;}).length!==0;},getBMPersonalization:function(builderID){return sQuery.grep(spApi.bannerManagementCamps,function(camp){return camp.builderID==builderID;})[0];},getCampOfThePage:function(campaignList)
{try{var mobileCamps=[];var webCamps=[];var tabletCamps=[];spApi.conditionCheckList=[];function collectCampaignsOnList(platformSpecificCampaignList,campaign){platformSpecificCampaignList.forEach(function(list){list.push(campaign);});};sQuery.each(campaignList,function(index,campaign){if(spApi.isMobileCamp(campaign)){collectCampaignsOnList([mobileCamps],campaign);}else if(spApi.isTabletCamp(campaign)){collectCampaignsOnList([tabletCamps],campaign);}else if(spApi.isAllPagesCamp(campaign)){collectCampaignsOnList([webCamps,tabletCamps,mobileCamps],campaign);}else{collectCampaignsOnList([webCamps],campaign);}});if(spApi.deviceDetect('PC')){campaignList=webCamps;}else if(spApi.deviceDetect('Mobil')){campaignList=mobileCamps;}else if(spApi.deviceDetect('Tablet')){campaignList=tabletCamps;}
if(spApi.isMobileBrowser()){var isControlGroupAdaptive;var infoProductType='24';function isCustomCampaign(campaign){return campaign.id.indexOf('c')>-1;}
function campaignIsMultiDevice(campaign){return isCustomCampaign(campaign)||(campaign.productType==infoProductType&&(spApi.notifies[campaign.id].mode=='adaptive'||isControlGroupAdaptive));}
function campaignIsSegmentedAsMultiDevice(segmentString){return(segmentString.indexOf('Mobil')>-1||segmentString.indexOf('Tablet')>-1||segmentString.indexOf('spApi.deviceDetect("All")')>-1);}
sQuery.each(webCamps,function(index,webCamp){if(webCamp.platform=="tablet"||webCamp.platform=="mobile"){return;}
isControlGroupAdaptive=false;if(webCamp.productType=='24'&&spApi.isControlCamp(webCamp.id)){var personalizationId=spApi.getPersonalizationId(webCamp.id);var personalizationVariations=spApi.personalizationCamps[personalizationId].variations;sQuery.each(personalizationVariations,function(index,variation){if(variation.varId!=webCamp.id){var tmpCamp=spApi.getCamp(variation.varId).camp;if(tmpCamp.productType=='24'&&spApi.notifies[tmpCamp.id].mode=='adaptive'){isControlGroupAdaptive=true;}}});}
if(campaignIsMultiDevice(webCamp)){var segment=webCamp.showIn.segment||[];sQuery.each(segment,function(index,segmentId){if(segmentId!==null){var segmentString=spApi.rules[segmentId].test;if(campaignIsSegmentedAsMultiDevice(segmentString)&&spApi.e(spApi.rules[segmentId].test)){campaignList.push(webCamp);}}});}});}else{campaignList=webCamps;}
spApi.getPersonalizationCamp();var now=Math.round(new Date()/1000);activeCamp=false;spApi.activeCamps=[];sQuery.each(campaignList,function(index,camp){if(camp.invalid){return true;}
if(camp.productAlias==='notification-center'){return true;}
if((camp.productAlias||'').indexOf('journey')>-1&&[58,50].indexOf(parseInt(camp.productType))===-1){return true;}
if(camp.isTriggerable==1){return true;}
if(!spApi.checkVarSegment(camp)){return true;}
if(!spApi.isCookieSupportEnabled()){return true;}
camp.trigTimeCount=(typeof camp.trigTimeCount=="undefined")?0:camp.trigTimeCount;var dateChecked=(camp.activeDateStart<now&&now<camp.activeDateEnd)?true:false;var showThis=true;var hideThis=false;var isFreqRuleOk=false;var isFreqRuleExist=false;if(!dateChecked){return true;}
if(!hideThis&&camp.showIn)
{if(camp.showIn.segment!=undefined&&camp.showIn.segment[0]!=null){sQuery.each(camp.showIn.segment,function(i,id){showThis=true;rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){showThis=false;return false;}
if(!spApi.checkCampaignLanguage(camp)){showThis=false;}});}
if(camp.showIn.trigger!=undefined&&camp.showIn.trigger[0]!=null&&camp.trigTimeCount==0){var triggerStatus=false;sQuery.each(camp.showIn.trigger,function(i,id){rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){triggerStatus=triggerStatus||false;}else{triggerStatus=triggerStatus||true;}});showThis=showThis&&triggerStatus;if(!spApi.checkCampaignLanguage(camp)){showThis=false;}}
if(typeof camp.showIn[0]!="undefined"){sQuery.each(camp.showIn,function(i,id){showThis=true;rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){showThis=false;return false;}
if(!spApi.checkCampaignLanguage(camp)){showThis=false;}});}
if(isFreqRuleExist)
showThis=showThis&&isFreqRuleOk;}
if(camp.locationisActive==1&&spApi.isMobileBrowser()){hideThis=true;showThis=false;}else{if(camp.productType!=20&&sQuery.cookie('sp-noteTimer')!=null){showThis=false;}
if(!spApi.checkDailyDisplay(camp)){showThis=false;}
if(showThis)
{if(spApi.checkConditionNeed(camp)&&spApi.storageData('sp-camp-'+camp.id)){return true;}
spApi.activeCamps.push(camp);if(sQuery.inArray(parseInt(camp.productType),spApi.paaProducts)>-1){return true;}
if(!activeCamp||parseInt(activeCamp.priority)>parseInt(camp.priority)){activeCamp=camp;}}}});if(!activeCamp)return false;spApi.activeCamp=activeCamp;spApi.logger('info','Active campaign : '+spApi.activeCamp.id);return spApi.activeCamp;}catch(err){spApi.errLog(err,{logType:'getCampOfThePage',bugType:'product',extraData:{param1:campaignList}});}},showCamp:function(camp,viewType)
{},loadInfoCss:function(){if(sQuery('#insStyleCss').length===0){var styleLink="<link id='insStyleCss' rel='stylesheet' href='//ilotteidstaging.api.useinsider.com/css/ins-style.css?v=0.1' type='text/css' media='screen'>";if(sQuery("head link[rel='stylesheet']")[0]){sQuery("head link[rel='stylesheet']").last().after(styleLink);}else{sQuery('head').append(styleLink);}}},showFramelessTemplate:{},checkConditionNeed:function(camp){if(typeof camp=='undefined'||camp==null){return false;}
if(typeof camp.isBounce!=='undefined'&&camp.isBounce=='1'){return true;}
if(typeof camp.conditionNeeds!=='undefined'&&((typeof camp.conditionNeeds.bounce!=='undefined'&&camp.conditionNeeds.bounce=='1')||(typeof camp.conditionNeeds.scroll!=='undefined'&&camp.conditionNeeds.scroll=='1'))){return true;}
return false;},getTime:function(){return Math.round(new Date()/1000);},getUTCTime:function(){var now=new Date();var time=now.getTime();var offset=now.getTimezoneOffset()*60000;return Math.round((time-offset)/1000);},isRefContains:function(data)
{var res=document.referrer.indexOf(data)>-1;return res;},hasText:function(selectedText,comparedText){try{if(typeof selectedText!=="undefined"&&selectedText!==null){return selectedText.indexOf(comparedText)>-1?true:false;}else{return false;}}catch(err){spApi.errLog(err,{logType:'hasText',bugType:'partner',extraData:{param1:selectedText,param2:comparedText}});}},hasParameter:function(name,exactMatch)
{try{if(typeof exactMatch==="undefined")
exactMatch=false;try{var uri=decodeURI(window.location.href);}catch(err){var uri=unescape(window.location.href);}
if(exactMatch==false){name=decodeURI(name.replace(/[\[\]\/\?]/g,"\\$&"));var regex=new RegExp(name);var results=regex.exec(uri);if(results==null){return false}else
return true;}else if(exactMatch==true){var pageUrl=window.location.href.replace('www.','');if(pageUrl==name){return true;}else{return false;}}}catch(err){spApi.errLog(err,{logType:'hasParameter',bugType:'product',extraData:{param1:name,param2:exactMatch}});}},checkCampaignLanguage:function(camp){if(camp.lang=='all_ALL'||sQuery.inArray(camp.productType,[32,39,47])>-1){return true;}
return spApi.getLang()==camp.lang;},addZeroToUtcHours:function(hour){if(hour<10){hour="0"+hour;}
return hour;},checkDailyDisplay:function(camp){try{var currentDate=new Date();var utcCurrentTime=spApi.addZeroToUtcHours(currentDate.getUTCHours())+':'+currentDate.getUTCMinutes();var utcCurrentDay=spApi.getUTCDayString(currentDate.getUTCDay());var dailyDisplay=camp.dailyDisplay;if(typeof dailyDisplay==='undefined'||!dailyDisplay.length>0){return true;}
dailyDisplay=JSON.parse(dailyDisplay);if(typeof dailyDisplay==='object'){if(dailyDisplay.end<=dailyDisplay.start){endTime=dailyDisplay.end.split(':');dailyDisplay.end=(parseInt(endTime[0])+24)+':'+endTime[1];}
if(sQuery.inArray('all',dailyDisplay.days)>-1||sQuery.inArray(utcCurrentDay,dailyDisplay.days)>-1){return utcCurrentTime>dailyDisplay.start&&utcCurrentTime<dailyDisplay.end;}}
return false;}catch(err){spApi.errLog(err,{logType:'dailyDisplay',bugType:'product'});return false;}},getUTCDayString:function(dayIndex){var weekDay=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return weekDay[dayIndex];},deviceDetect:function(targetDevice){if(targetDevice=='All')return true;var userAgent=navigator.userAgent.toLowerCase();var isMobile=(/iphone|ipod|android|blackberry|opera mini|opera mobi|skyfire|maemo|windows phone|palm|iemobile|symbian|symbianos|fennec/i.test(userAgent));var isTablet=(/(?!.*tablet pc)(ipad|android|sch-i800|playbook|tablet|kindle|gt-p1000|sgh-t849|shw-m180s|a510|a511|a100|dell streak|silk)/i).test(userAgent);if(userAgent.toLowerCase().indexOf('android')>-1){isTablet=isTablet&&userAgent.indexOf('mobile')==-1;isMobile=isMobile&&userAgent.indexOf('mobile')!=-1;}
var device='PC';if(isMobile){device='Mobil';}else if(isTablet){device='Tablet';}
return device==targetDevice;},isOnPanel:function(){try{return window.self!==window.top;}catch(err){spApi.errLog(err,{logType:'isOnPanel',bugType:'partner',extraData:{}});}},getParameter:function(name)
{name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&#]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(window.location.href);if(results==null){return"";}else{try{var unfilteredValue=decodeURIComponent(results[1].replace(/\+/g," "));return unfilteredValue.replace(/<[^>]+>/ig,"");}catch(err){spApi.errLog(err);return unescape(results[1].replace(/\+/g," "));}}},isParameter:function(name)
{var parameter=spApi.getParameter(name);return(parameter!="")?true:false;},getUserData:function(dataType)
{try{if(dataType=="gender"){if(JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="erkek"){return"male";}else if(JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="kadın"||JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="kadin"){return"female";}else{return JSON.parse(localStorage.getItem('spUserData'))[dataType];}}else{return JSON.parse(localStorage.getItem('spUserData'))[dataType];}}catch(err){spApi.errLog(err,{logType:'getUserData',bugType:'product',extraData:{param1:dataType}});}},setSessionStorage:function(storageName,storeValue)
{spApi.sessionStorageSet(storageName,JSON.stringify(storeValue));},getSessionStorage:function(storageName)
{try{return JSON.parse(spApi.sessionStorageGet(storageName))}catch(err){spApi.errLog(err);spApi.setSessionStorage(storageName,'');return[];}},getJourneyCamp:function(journeyId){return spApi.journeyCamps.filter(function(journeyCamp){return journeyCamp.id==journeyId;})[0];},updateCookie:function(data,type){try{type=typeof type!=='undefined'?type:"general";var campId;if(data.campId)
campId=data.campId;var cookieExpireDate=14;if(typeof campId!=='undefined'){var controlCamp=spApi.getCamp(campId);if(typeof controlCamp.camp!=='undefined'){cookieExpireDate=parseInt(controlCamp.camp.cookieTime);}else if(typeof spApi.webPushes[campId]!=='undefined'){cookieExpireDate=parseInt(spApi.webPushes[campId].cookieTime);}else if(data.key.indexOf('ins-wp')>-1&&!spApi.hasParameter('journeyId')){var ONE_DAY_AS_MILLISECONDS=86400000;cookieExpireDate=(new Date().setHours(0,0,0,0)+ONE_DAY_AS_MILLISECONDS-new Date().getTime())/ONE_DAY_AS_MILLISECONDS;}}
if(data.key.indexOf('ins-journey-camp')>-1){cookieExpireDate=spApi.getJourneyCamp(data.obj.journeyId).cookieTime;}
var isLocalstorage=false;var localStorageList=['sp-camp','ins-insight','sp-goal','user-segments','paid-products','ins-wp','prodCats','ins-journey-camp','ins-fbm'];sQuery.each(localStorageList,function(index,keyName){if(data.key.indexOf(keyName)>-1){isLocalstorage=true;}});c=(isLocalstorage&&spApi.storageData(data.key)!=null)?spApi.storageData(data.key):sQuery.cookie(data.key);if(data.key.indexOf('sp-camp-')>-1&&spApi.salesSesId!=spApi.Base64.encode('0')){if(c==null){data.obj.salesSesId=spApi.Base64.decode(spApi.salesSesId);data.obj.salesSesTime=spApi.getTime();}}
newC=data.obj;if(data.key=='user-segments'){var cookieExpireDate=new Date();cookieExpireDate.setTime(cookieExpireDate.getTime()+(60*60*1000));}
if(data.obj['step1-displayed']){var camp=spApi.getCamp(campId).camp||{};var now=new Date();var campaignStorage=spApi.getStorageValue(data.key);var currentSalesLogDuration=campaignStorage?campaignStorage.salesLogDuration:new Date().setMinutes(now.getMinutes()+30);var currentSalesLogDurationTime=new Date(currentSalesLogDuration);if(!campaignStorage||!campaignStorage.salesLogDuration){data.obj.viDa=spApi.getTime();if(camp.sessionBasedGoal==="0"){data.obj.salesLogDuration=now.setHours(now.getHours()+parseInt(camp.saLogDuration));}}
if(camp.sessionBasedGoal==="1"){if(now.getHours()===0&&currentSalesLogDurationTime.getHours()===0&&currentSalesLogDurationTime.getMinutes()<now.getMinutes()){data.obj.salesLogDuration=now.setMinutes(now.getMinutes()-30);}else if(!currentSalesLogDuration||!spApi.isOnAfterPaymentPage()&&currentSalesLogDuration>now.getTime()){data.obj.isSessionBasedSalesLogDuration='true';data.obj.salesLogDuration=now.setMinutes(now.getMinutes()+30);spApi.setSessionBasedSalesLogDurationEvent();}}}else if(data.obj['joined']||data.obj['liked']){data.obj.joDa=spApi.getTime();}else if(data.obj['closed']){data.obj.clDa=spApi.getTime();}
if(c){if(data.key=='sp-notes'){sQuery.cookie(data.key,c,{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{oldC=JSON.parse(c);newC=sQuery.extend(true,oldC,newC);if(!isLocalstorage){sQuery.cookie(data.key,sQuery.toJSON(newC),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{spApi.storageData(data.key,sQuery.toJSON(newC),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}}}else{if(data.key=='sp-notes'){sQuery.cookie(data.key,data.obj,{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{if(!isLocalstorage){sQuery.cookie(data.key,sQuery.toJSON(data.obj),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{spApi.storageData(data.key,sQuery.toJSON(data.obj),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}}}
if(type!="AB"&&data.key!='sp-notes'&&type!="nolog"){newC.table=data.table;this.worker.check(JSON.parse(c),newC,campId);}
if(typeof campId!=='undefined'){spApi.triggerInspectorLogs(JSON.stringify({type:Object.keys(data.obj)[0],'campId':campId.toString()}));}}catch(err){spApi.errLog(err,{logType:'updateCookie',bugType:'product',extraData:{param1:data,param2:type}});}},isAudienceProduct:function(campId){var paaProductIds=['32','39','40','47'];return typeof campId!=='undefined'&&typeof spApi.getCamp(campId).camp!=='undefined'&&paaProductIds.indexOf(spApi.getCamp(campId).camp.productType)>-1;},setCookie:function(data,callback){this.worker.cookie(data,callback);},isFreqRule:function(rule){try{return rule.test.indexOf("getMinutes")<0?false:true;}
catch(err){spApi.errLog(err);return false;}},validateEmail:function(email,limit){if(!email){return false;}
if(!limit){var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;}else{var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{3,4})?$/;}
if(emailReg.test(email)){return true;}
return false;},reformatDate:function(date,withTimeString){try{date=date||'';if(!date||date.length<10)
return date;date=date.toString();var mappedText=date;if(date.replace(/[0-9]/g,"").length===0){if(date.length==10){date=parseInt(date*1000);}
var date=new Date(parseInt(date));mappedText=date.getFullYear()+'-'+("00"+(date.getMonth()+1)).substr(-2,2)+'-'+("00"+date.getDate()).substr(-2,2);if(withTimeString){mappedText=mappedText+' '+("00"+date.getHours()).substr(-2,2)+':'+("00"+date.getMinutes()).substr(-2,2)+':'+("00"+date.getSeconds()).substr(-2,2);}}
else{date=date.replace(/[^0-9]/g,"-");mappedText=date;var splitDate=date.split('-');if(splitDate.length!==3)
return'';if(splitDate[0].length<4){mappedText=splitDate[2]+'-'+splitDate[1]+'-'+splitDate[0];}}
return mappedText;}catch(err){spApi.errLog(err,{logType:'reformatDate',bugType:'product'});}},hashCode:function(str){var hash=0;if(str.length===0){return hash;}
for(var i=0;i<str.length;i++){var char=str.charCodeAt(i);hash=((hash<<5)-hash)+char;hash=hash&hash;}
return Math.abs(hash);},widgets:{},spCampCheckStatus:function(id,condition){try{if(typeof(id)=='undefined'||id=='undefined')return false;var c=spApi.storageData('sp-camp-'+id);var id=id.toString();if(!c||id=='undefined')
return false;else{var controlCamp=spApi.getCamp(id);c=JSON.parse(c);var status=(condition=="liked")?(c["liked"]||c["closed"]):(c[condition]==true?true:false);if(condition=="liked"||condition=="joined"){tempId=id.toString();if(tempId.indexOf('c')<0){controlCamp=controlCamp.camp;var closeLimitStatus=false;var joinLimitStatus=false;if(c["joDa"]!=undefined){joinLimitStatus=joinLimitStatus=c["joDa"]+controlCamp.joinControlLimit*60*60>spApi.getTime();}
if(c["clDa"]!=undefined){closeLimitStatus=c["clDa"]+controlCamp.closeControlLimit*60*60>spApi.getTime();}
status=status&&(closeLimitStatus||joinLimitStatus);}}else if(condition=="closed"&&c["clDa"]!=undefined){status=status&&c["clDa"]>spApi.getTime()-controlCamp.closeControlLimit*60*60;}
if(typeof status==='string'){return status=="";}else{return status==true;}}}catch(err){spApi.errLog(err,{logType:'spCampCheckStatus',bugType:'product',extraData:{param1:id,param2:condition}});}},getStandardLogData:function(){var data={originalPrice:spApi.getExchangeRate(spApi.preferredCurrency,sQuery.cookie('current-currency'),sQuery.cookie('total-cart-amount'),'price'),originalCurrency:(sQuery.cookie('current-currency')!=null)?sQuery.cookie('current-currency'):'',convertedCurrency:spApi.preferredCurrency,convertedPrice:(sQuery.cookie('total-cart-amount')!=null)?sQuery.cookie('total-cart-amount'):'',sessionId:spApi.salesSesId};return data;},setSaLog:function(id,condition,sendLog){if(sendLog!==false&&window.spSalesOk==1)return;window.spSalesOk=1;var orderID=(spApi.getOrderId()!=undefined&&spApi.getOrderId()!=null&&spApi.getOrderId()!='')?spApi.getOrderId():'ins_unknown_'+Math.random().toString(36).substr(2,5)+'_'+spApi.getTime();var salesOrderId=sQuery.cookie("salesOrderId");if(salesOrderId!=null&&salesOrderId==orderID){return;}else{sQuery.cookie("salesOrderId",orderID,{path:'/',domain:cookieDomain});}
var cookies=spApi.allStorageData();var joinSalesEnable=false;var joinDate=false;var viewDate=false;var bSP=1333411200;var lastJoinDate=lastViewDate=bSP;var logObj=new Object();var lastCookieForCatch='';sQuery.each(cookies,function(i,obj){var cookieKey=obj.key;var value=unescape(obj.value);try{if(cookieKey.indexOf("sp-camp")!=-1){if(value.indexOf("joined")!=-1||value.indexOf("liked")==-1||value.indexOf("step1-displayed")!=-1){lastCookieForCatch=value;var logType='bounce-sales';var cookieContent=JSON.parse(value);if(value.indexOf("joined")!=-1||value.indexOf("liked")!=-1){logType='sales';joinSalesEnable=true;joinDate=typeof cookieContent.joDa!=='undefined'?cookieContent.joDa:bSP;}else if(joinSalesEnable){return;}else{viewDate=bSP;if(cookieContent!=null&&cookieContent.viDa!=='undefined'){viewDate=cookieContent.viDa;}}
if(joinSalesEnable&&joinDate>=lastJoinDate){lastJoinDate=joinDate;logObj=setLogVariable(cookieKey,cookieContent,logType);}else if(!joinSalesEnable&&viewDate>=lastViewDate){lastViewDate=viewDate;logObj=setLogVariable(cookieKey,cookieContent,logType);}}}}catch(err){spApi.errLog(err,{logType:'setSaLog',bugType:'product',extraData:{param1:lastCookieForCatch}});}});if(typeof spApi.setInsightSalesLog==='function'){spApi.setInsightSalesLog(orderID);}
function setLogVariable(cookie,cookieContent,logType){var logObj=new Object();id=cookie.split("-");if(id[2].indexOf("c")>=0){logObj.id=Number(id[2].replace("c",""));logObj.productType="custom";logObj.salesProductType=20;logObj.table='customLogs'}else{logObj.id=Number(id[2]);logObj.productType="other";logObj.salesProductType=logObj.productType;logObj.table='campLogs'}
logObj.type="";logObj.coupon=cookieContent.c;logObj.amount=sQuery.cookie('total-cart-amount');logObj.products=spApi.storageData('paid-products');logObj.logType=logType;return logObj;}
if(sendLog===false)return logObj;try{sQuery.each(spApi.personalizationCamps,function(key,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varIdKey,variation){if(typeof variation=='undefined'){return;}
if(spApi.spCampCheckStatus(variation.varId,"step1-displayed")){var campaignStorage=spApi.getStorageValue('sp-camp-'+variation.varId);if(typeof spApi.getCamp(variation.varId).camp!=='undefined'&&typeof spApi.getCamp(variation.varId).camp.saLogDuration!=='undefined'){var campSaLogDuration=campaignStorage.salesLogDuration;}else{var campSaLogDuration=new Date().setHours(336);}
if(campSaLogDuration>spApi.getTime()*1000){var variationSalesProductType=spApi.getCamp(variation.varId).camp.productType=='20'?'custom':'other';var logParams={campId:variation.varId,referer:encodeURIComponent(logObj.amount),ref:window.document.referrer,url:window.document.URL,productType:variationSalesProductType,multivariateGroup:key,orderId:orderID,paidProducts:logObj.products,sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(variation.varId,'salesSesId',spApi.getCamp(variation.varId).camp.productType),salesSesTime:spApi.getCampSalesSesInfo(variation.varId,'salesSesTime',spApi.getCamp(variation.varId).camp.productType)+'-'+spApi.getTime(),appliedCode:spApi.getAppliedCode(variation.varId),salesType:'variation-sales',table:variationSalesProductType==='custom'?'customLogs':'campLogs'};logParams=sQuery.extend(logParams,spApi.getStandardLogData());spApi.worker.send('sales-log',logParams);}}});});}catch(e){spApi.errLog(e,{logType:'setLogVariable (variation-sales) ',bugType:'product'});spApi.conLog('personalizationCamps log error');spApi.conLog(e);}
if(id){var saleCampId=(logObj.productType=="custom")?('c'+logObj.id):(logObj.id);var campaignStorage=spApi.getStorageValue('sp-camp-'+saleCampId);if(typeof spApi.getCamp(saleCampId).camp!=='undefined'&&typeof spApi.getCamp(saleCampId).camp.saLogDuration!=='undefined'){var campSaLogDuration=campaignStorage.salesLogDuration;}else{var campSaLogDuration=new Date().setHours(336);}
if((logObj.logType!='sales'&&logObj.logType!='bounce-sales')||campSaLogDuration>spApi.getTime()*1000){var logParams={campId:logObj.id,referer:logObj.amount||'0',ref:window.document.referrer,url:window.document.URL,productType:logObj.productType,paidProducts:logObj.products,sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logObj.id,'salesSesId',logObj.salesProductType),salesSesTime:spApi.getCampSalesSesInfo(logObj.id,'salesSesTime',logObj.salesProductType)+'-'+spApi.getTime(),appliedCode:spApi.getAppliedCode(logObj.id),orderId:orderID,salesType:logObj.logType+logObj.type,table:logObj.table};logParams=sQuery.extend(logParams,spApi.getStandardLogData());this.worker.send('sales-log',logParams);}}
var logParams={type:'sa-co',orderId:orderID,paidProducts:(spApi.storageData('paid-products')!=null)?spApi.storageData('paid-products'):'',sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logObj.id,'salesSesId',logObj.salesProductType),salesSesTime:spApi.getCampSalesSesInfo(logObj.id,'salesSesTime',logObj.salesProductType)+'-'+spApi.getTime(),referer:sQuery.cookie('total-cart-amount')||'0',ref:window.document.referrer,campId:0,table:'campLogs'};var paaGroup=spApi.storageData('paaGroup');if(['ins-roi-experiment-impression','ins-roi-control-impression'].indexOf(paaGroup)!==-1){logParams.paaRoiSalesLogType=paaGroup==='ins-roi-experiment-impression'?'ins-roi-experiment-sale':'ins-roi-control-sale';}
logParams=sQuery.extend(logParams,spApi.getStandardLogData());this.worker.send('do-logging',logParams);return logObj;},isMobileBrowser:function(){(function(a){sQuery.browser.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);if((/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||sQuery.browser.mobile)){if(typeof window.isMobileBrowser=='undefined'){spApi.consoleLog.push('API is steady for mobile devices.');window.isMobileBrowser=true;}
return true;}else{return false;}},isAndroid:function(){return navigator.userAgent.toLowerCase().indexOf('android')>-1;},getAndroidVersion:function(){var match=navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/);return match?match[1]:-1;},isMobileCamp:function(campaign){var status=false;if(typeof campaign!='undefined'){if(campaign.platform==='mobile'&&!spApi.deviceDetect('Tablet')){status=true;}else if(spApi.isMobileBrowser()){status=(campaign.productType=='30')?true:status;}}
return status;},isTabletCamp:function(campaign){return campaign.platform==='tablet';},isAllPagesCamp:function(campaign){return campaign.platform==='all';},showNotes:function(data,fromJoin,fromPurcha){},noteTimer:function(data){},gaSend:function(l,caller){},getGAStyleSesId:function(){var id=sQuery.cookie('ins-gaSSId');try{spApi.logger('info','set gaStyleSession id ');var sessionInit=false;var expDate=new Date();expDate.setTime(expDate.getTime()+(30*60*1000));var cookieSettings={expires:expDate,path:'/',domain:cookieDomain};var isSessionExpired=!id;if(!isSessionExpired){var oldSession=/.+_(.*)/.exec(id);if(oldSession&&oldSession.length==2){isSessionExpired=(new Date(oldSession[1]*1000)).getUTCDate()!=(new Date()).getUTCDate();}}
if(isSessionExpired){spApi.logger('info','update gaStyleSession id !');sessionInit=true;function guid(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return s4()+s4()+'-'+s4()+'-'+s4()+'-'+s4()+'-'+s4()+s4()+s4();}
id=guid()+'_'+spApi.getTime();spApi.logInsight();}
if(typeof spApi.sessionInit==='undefined'){spApi.sessionInit=sessionInit;}
sQuery.cookie('ins-gaSSId',id,cookieSettings);}catch(err){spApi.errLog(err,{logType:'getGAStyleSesId',bugType:'partner'});}
return id;},logInsight:function(){try{var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;if(key.indexOf("ins-insight-")!=-1){var logData={key:sQuery.trim(key),obj:sQuery.toJSON(null)};spApi.updateCookie(logData,'nolog');}});}catch(err){spApi.errLog(err,{logType:'logInsight',bugType:'partner'});}},cartCatCount:function(_cat){try{if(!spApi.isOnCartPage())return;var success=false;var count=0;var products=spApi.getPaidProducts()||[];var prodCats=JSON.parse(spApi.storageData('prodCats'))||[];if(typeof products=="undefined"||typeof prodCats=="undefined"||products.length==0||prodCats.length==0)return count;sQuery.each(products,function(i,product){success=false;sQuery.each(prodCats,function(j,cat){if(sQuery.trim(decodeURIComponent(cat.name))==sQuery.trim(product.name)&&cat.cat.toLowerCase().indexOf(_cat.toLowerCase())!=-1){success=true;return false;}});if(success)count++;});return count;}catch(err){spApi.errLog(err,{logType:'cartCatCount',bugType:'partner',extraData:{param1:_cat}});}},getCamp:function(campId){if(typeof this.sortCamp=="undefined"){this.sortCamp={};var me=this;sQuery.each(spApi.camps.concat(spApi.customizationCamps),function(key,camp){me.sortCamp[camp.id]=camp;});}
var campObject={};campObject.camp=this.sortCamp[campId];return campObject;},setApiInitConditions:function(){try{if(spApi.apiInitConfig.inited){spApi.logger('warning','setApiInitConditions method has already executed');return false;}
var singlePageDesktopActive=0;var singlePageMobileActive=0;var mobileApiDelay=0;var desktopApiDelay=0;spApi.apiInitConfig.inited=true;var apiInitConfig=function(){if(spApi.apiInitConfig.mobile instanceof Object&&spApi.isMobileBrowser()){return spApi.apiInitConfig.mobile;}else if(spApi.apiInitConfig.desktop instanceof Object&&!spApi.isMobileBrowser()){return spApi.apiInitConfig.desktop;}else if(spApi.apiInitConfig.conditions instanceof Array){return spApi.apiInitConfig;}else if(!spApi.apiInitConfig.mobile&&!spApi.apiInitConfig.desktop){return{conditions:[{listenUrlChange:true}]};}}();var InitConditionsManager=function(apiInitConfig){this.CHECK_TYPE_EXISTS='exists';this.CHECK_TYPE_NOT_EXISTS='not exists';this.CHECK_TYPE_REMOVED='removed';this.CHECK_TYPE_CONTAINS='contains';this.CHECK_TYPE_NOT_CONTAINS='not contains';this.CHECK_TYPE_IS='is';this.CHECK_TYPE_IS_NOT='is not';this.CHECK_TYPE_CLICK='click';this.CLICK_LISTENER_ELEMENT_CLASS='ins-init-condition-tracking';this.CLICK_CHECK_ELEMENT_CLASS='ins-init-condition-clicked';this.singlePageApiDelay=this.apiDelayByPlatform();this.referenceElement=sQuery(apiInitConfig.referenceElement||'body')[0]||document;this.lastUrl=location.href;this.urlChanged=false;this.conditions=apiInitConfig.conditions;this.clickListenerInited=false;return this;};InitConditionsManager.prototype.init=function(){if(this.conditions.length===0||!this.singlePageActive()){return;}
if(window.MutationObserver&&this.referenceElement){setTimeout(function(){var observer=new MutationObserver(this.mutationCallback.bind(this));observer.observe(this.referenceElement,{childList:true,subtree:true});}.bind(this),0);}else{this.referenceElement.addEventListener('DOMSubtreeModified',this.mutationCallback);}};InitConditionsManager.prototype.singlePageActive=function(){return(singlePageMobileActive&&spApi.isMobileBrowser())||(singlePageDesktopActive&&!spApi.isMobileBrowser());};InitConditionsManager.prototype.apiDelayByPlatform=function(){if(spApi.isMobileBrowser()){return mobileApiDelay;}
return desktopApiDelay;};InitConditionsManager.prototype.mutationCallback=spApi.debounce(function(){var initFlag=false;if(this.lastUrl!==location.href){this.lastUrl=location.href;this.urlChanged=true;}
if(this.conditions.length>0){sQuery.each(this.conditions,function(index,condition){condition.status=condition.status||{};if(condition.listenUrlChange&&!this.urlChanged){return;}
if(condition.url&&this.checkUrlCondition(condition.url)&&condition.element){condition.status.url=true;if(this.checkElementCondition(condition.element)){condition.status.element=true;this.reInitApi('Condition group is true:',condition);}
return false;}else if(condition.url&&this.urlChanged){initFlag=this.checkUrlCondition(condition.url);}else if(condition.element&&!condition.url){initFlag=this.checkElementCondition(condition.element);}else if(condition.listenUrlChange&&this.urlChanged){condition.status.urlChanged=true;initFlag=true;}
if(initFlag){if(condition.url){condition.status.url=true;}else if(condition.element){condition.status.element=true;}
this.reInitApi('Condition group is true:',condition);return false;}}.bind(this));}else if(this.urlChanged){this.reInitApi('Url has been changed');}},(apiInitConfig.mutationDelay||100));InitConditionsManager.prototype.reInitApi=function(log,condition){condition=condition||{};spApi.logger('info',log+':'+JSON.stringify(condition));this.urlChanged=false;spApi.debounce(spApi.reInitOnChange,condition.delay||this.singlePageApiDelay)();};InitConditionsManager.prototype.checkUrlCondition=function(condition){var initFlag=false;if(typeof condition==='string'){condition=[condition];}
var conditions=condition||[];sQuery.each(conditions,function(index,condition){if(typeof condition==='string'){initFlag=this.checkUrl(condition,this.CHECK_TYPE_CONTAINS);}else if(condition instanceof Object){initFlag=this.checkUrl(condition.keyword,condition.checkType||this.CHECK_TYPE_CONTAINS);}
if(!initFlag){return false;}}.bind(this));return initFlag;};InitConditionsManager.prototype.checkUrl=function(keyword,checkType){if(checkType===this.CHECK_TYPE_IS){return keyword===location.href;}else if(checkType===this.CHECK_TYPE_IS_NOT){return keyword!==location.href;}else if(checkType===this.CHECK_TYPE_CONTAINS){return location.href.indexOf(keyword)!==-1;}else if(checkType===this.CHECK_TYPE_NOT_CONTAINS){return location.href.indexOf(keyword)===-1;}
spApi.logger('warning','Unsupported checkType:'+checkType);return false;};InitConditionsManager.prototype.checkElementCondition=function(condition){if(typeof condition==='string'){condition=[{selector:condition,checkType:this.CHECK_TYPE_EXISTS}];}
var conditions=condition||[];sQuery.each(conditions,function(index,condition){if(typeof condition==='string'){condition={selector:condition,checkType:this.CHECK_TYPE_EXISTS};conditions[index]=condition;}
if(condition instanceof Object){if(this.checkElement(condition)){condition.status=true;}}}.bind(this));var conditionStatusCount=conditions.filter(function(condition){return condition.status;}).length;if(conditionStatusCount===conditions.length){conditions=conditions.map(function(condition){condition.status=false;});return true;}
return false;};InitConditionsManager.prototype.checkElement=function(condition){var checkType=condition.checkType||this.CHECK_TYPE_EXISTS;var selector=condition.selector;if(checkType===this.CHECK_TYPE_EXISTS){var encodedSelector=btoa(condition);var elementAttributeValue=sQuery(selector).attr('ins-init-condition')||'';if(sQuery(selector).exists()&&elementAttributeValue.indexOf(encodedSelector)===-1){sQuery(selector).attr('ins-init-condition',elementAttributeValue+'#'+encodedSelector);return true;}
return false;}else if(checkType===this.CHECK_TYPE_NOT_EXISTS){return!sQuery(selector).exists();}else if(checkType===this.CHECK_TYPE_CLICK){sQuery(selector).addClass(this.CLICK_LISTENER_ELEMENT_CLASS);this.listenClickEvents();if(sQuery(selector).hasClass(this.CLICK_CHECK_ELEMENT_CLASS)){sQuery(selector).removeClass(this.CLICK_CHECK_ELEMENT_CLASS);return true;}
return false;}else if(checkType===this.CHECK_TYPE_REMOVED){if(sQuery(selector).exists()){condition.showed=true;return false;}else if(condition.showed){condition.showed=false;return true;}
return false;}
spApi.logger('warning','Unsupported checkType:'+checkType);return false;};InitConditionsManager.prototype.listenClickEvents=function(){if(this.clickListenerInited===true){return;}
this.clickListenerInited=true;sQuery(document).on('clickedElement',function(event,element){if(!sQuery(element).hasClass(this.CLICK_LISTENER_ELEMENT_CLASS)){return;}
sQuery(element).addClass(this.CLICK_CHECK_ELEMENT_CLASS);this.mutationCallback();}.bind(this));};new InitConditionsManager(apiInitConfig).init();}catch(error){spApi.errLog(error,{logType:'setApiInitConditions',bugType:'product'});}},reInitOnChangeCallbacks:[],reInitOnChange:function(){try{sQuery(window).trigger('resetTimeOnSite');spApi.reInitOnChangeCallbacks.forEach(function(callback){callback()});if(sQuery.fancybox){var sliderCampList=[];var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;var value=unescape(obj.value);if(key.indexOf('sp-camp-')==-1)return;if(typeof spApi.notifies[key.match(/\d+/g)[0]]=="undefined")return;if(spApi.notifies[key.match(/\d+/g)[0]].category!="7")return;if(value.indexOf('hideSlider')!=-1)return;sliderCampList.push(key.match(/\d+/g)[0]);});spApi.isFirstVersus=false;sQuery.fancybox.close();sQuery('.sp-inner-notification').remove();sQuery('.sp-inline-wrap').remove();sQuery('.ins-preview-wrapper').remove();sQuery(window).unbind('scroll.insFrameless');sQuery(window).unbind('resize.insFrameless');clearInterval(spApi.cartInterval);sQuery.each(sliderCampList,function(key,campId){var campCookie=JSON.parse(spApi.storageData('sp-camp-'+campId));if(campCookie!=null){delete campCookie.hideSlider;spApi.storageData('sp-camp-'+campId,JSON.stringify(campCookie),{expires:14,path:'/',domain:cookieDomain});}});}
spApi.conLog('init');spApi.clearCustomCamps();spApi.clearElementLoadComplete();spApi.resetCampaignsSettings();spApi.personalizationSetStatus=false;spApi.sessionInit=undefined;spApi.activeBannerManagementCamps=[];spApi.showedCampaignList=[];spApi.hitSend=false;spApi.isWebPushInitialized=false;(spApi.cartAbandonmentEmail||{}).providerIndex=0;sQuery(document).trigger('resetInspector.insider');spApi.resetSystemRulesCallLimits();spApi.init(false);spApi.executedCallbacks=[];}catch(err){spApi.errLog(err,{logType:'reinitOnParameterChange',bugType:'partner',extraData:{paramer:location.href}});}},clearElementLoadComplete:function(){spApi.logger('info','ElementLoadComplete is clearing.');spApi.elementLoadCompleteConfig.mutableList.forEach(function(mutableObject){clearTimeout(mutableObject.notFoundCallbackTimeout);});if(typeof spApi.elementLoadCompleteConfig.disconnect==='function'){spApi.elementLoadCompleteConfig.disconnect();}
document.body.removeEventListener('DOMSubtreeModified',spApi.elementLoadCompleteConfig.mutationCallback);spApi.elementLoadCompleteConfig.mutableList=[];spApi.elementLoadCompleteConfig.inited=false;},resetCampaignsSettings:function(){spApi.logger('info','Campaigns are converting to valid.');spApi.camps.forEach(function(camp){camp.invalid=undefined;});},isTargetingReady:function(camp){var builderId=spApi.getBuilderIdFromVar(camp.id);return camp.isTest!=1||(camp.isTest==1&&builderId in spApi.getCampBuilderCandidates());},waitElementWithInterval:function(config){var elementWaitInterval=setInterval(function(){if(sQuery(config.selector).exists()){config.callback(sQuery(config.selector));clearInterval(elementWaitInterval);elementWaitInterval=false;}},100);setTimeout(function(){if(elementWaitInterval){spApi.logger('warning','Selector not found.'+config.selector);clearInterval(elementWaitInterval);if(typeof config.notFoundCallback==='function'){config.notFoundCallback();}}},config.timeout);},setSessionBasedSalesLogDurationEvent:function(){spApi.eventManager(document).on('click',spApi.debounce(function(){spApi.allStorageData().forEach(function(campaign){if(campaign.key.indexOf('sp-camp')>-1&&JSON.parse(campaign.value).isSessionBasedSalesLogDuration==='true'&&!spApi.isGoalConversionDurationExpired(campaign.key.split('-').pop())){var storageData=JSON.parse(campaign.value);var salesLogDuration=new Date();storageData.salesLogDuration=salesLogDuration.setMinutes(salesLogDuration.getMinutes()+30);spApi.storageData(campaign.key,JSON.stringify(storageData));}});},100))},getStorageValue:function(key){return spApi.storageData(key)?JSON.parse(spApi.storageData(key)):false;},isGoalConversionDurationExpired:function(variationId){var salesLogDuration=spApi.getStorageValue('sp-camp-'+variationId).salesLogDuration;return salesLogDuration<spApi.getTime()*1000;},customizationLog:function(){spApi.logger('warning','We removed this function from API, please remove this function from campaign.');},getPersonalizationCamp:function(){if(!spApi.personalizationSetStatus){spApi.personalizationSetStatus=true;}else{return;}
spApi.userSegments=spApi.storageData("user-segments")==null?{}:sQuery.parseJSON(spApi.storageData("user-segments"));var newSegmentList=new Object();sQuery.each(spApi.personalizationCamps,function(prsnlztnId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
if(spApi.userSegments[prsnlztnId]==undefined||typeof spApi.userSegments[prsnlztnId]=='undefined'){try{var isSegmentValid=true;var prsnlztnStatus=false;if(prsnlztn.segment!=undefined&&prsnlztn.segment!=null&&prsnlztn.segment.length>0){if(!spApi.e(spApi.rules[prsnlztn.segment[0]].test)){isSegmentValid=false;}else{delete spApi.userSegments[prsnlztnId];}}}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok1-'+prsnlztnId,bugType:'partner',extraData:{param1:JSON.stringify(prsnlztn)}});}
var totalRatio=0;var randomRatio=parseInt(Math.random()*100);var displayedVar=false;if(isSegmentValid){sQuery.each(prsnlztn.variations,function(key,variation){try{if(variation!=null&&variation.varId){if(!spApi.spCampCheckStatus(variation.varId,"step1-displayed")){oldRatio=Number(totalRatio);totalRatio+=Number(variation.ratio);if(!displayedVar&&oldRatio<=randomRatio&&randomRatio<totalRatio){spApi.userSegments[prsnlztnId]=variation.varId;newSegmentList[prsnlztnId]={id:variation.varId,ratio:"o:"+oldRatio+" r:"+randomRatio+" t:"+totalRatio+" var ratio:"+variation.ratio};return true;}}else{spApi.userSegments[prsnlztnId]=variation.varId;newSegmentList[prsnlztnId]={id:variation.varId,ratio:"already shown. var ratio:"+variation.ratio};return false;}}}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok2-'+prsnlztnId,bugType:'partner',extraData:{param1:JSON.stringify(variation)}});}});}}});try{var data={key:'user-segments',obj:spApi.userSegments};spApi.updateCookie(data,"nolog");}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok3',bugType:'partner',extraData:{param1:JSON.stringify(tempSegment)}});}},getPersonalizationId:function(id){var variationCampId;try{sQuery.each(spApi.personalizationCamps,function(campId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varKey,variation){if(variation.varId==id){variationCampId=campId;}});});return variationCampId;}catch(err){spApi.errLog(err,{logType:'getPersonalizationId',bugType:'partner',extraData:{param1:id}});}},isControlCamp:function(id){var cgStatus=false;sQuery.each(spApi.personalizationCamps,function(campId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varKey,variation){if(typeof prsnlztn=='undefined'){return;}
if(variation.varId==id&&variation.type=="cg"){cgStatus=true;}});});return cgStatus;},checkVarSegment:function(variation){var status=true;sQuery.each(spApi.personalizationCamps,function(prsnlztnId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(key,vari){if(typeof prsnlztn=='undefined'){return;}
if(vari&&vari.varId==variation['id']){if(spApi.userSegments[prsnlztnId]==variation['id']){status=true;return true;}else{status=false;return false;}}});});return status;},addGoalTracking:function(){},checkCampBuilderTest:function()
{if(!panelEdit){return(!spApi.hasParameter('insExitTestMode')&&(spApi.hasParameter('campBuilderTest')||document.referrer.indexOf("campBuilderTest")>-1||sQuery.cookie('variationCandidate')!=null))?true:false;}
return false;},getCampBuilderCandidates:function()
{try{var referrerUrl=decodeURIComponent(document.referrer);var vc=sQuery.cookie("variationCandidate");var segment=(vc=="undefined"||vc==null)?{}:sQuery.parseJSON(sQuery.cookie("variationCandidate"));if(spApi.checkCampBuilderTest()&&spApi.hasParameter('insBuild'))
segment=sQuery.parseJSON('{"'+spApi.Base64.decode(spApi.getParameter('insBuild'))+'":"'+spApi.Base64.decode(spApi.getParameter('insVar'))+'"}');else if(spApi.checkCampBuilderTest()&&referrerUrl.indexOf("insBuild")>-1)
segment=sQuery.parseJSON('{"'+spApi.Base64.decode(spApi.getParameterFromUrl(referrerUrl,'insBuild'))+'":"'+spApi.Base64.decode(spApi.getParameterFromUrl(referrerUrl,'insVar'))+'"}');return segment;}catch(err){spApi.errLog(err,{logType:'getCampBuilderCandidates',bugType:'product'});}},setCampBuilderTest:function()
{if(spApi.checkCampBuilderTest()){sQuery.cookie("variationCandidate",JSON.stringify(spApi.getCampBuilderCandidates()),{path:'/',domain:cookieDomain});}
spApi.showCampBuilderTestInfo()},getObjectFirstKey:function(obj)
{for(var i in obj)
return i;return 0;},getObjectValue:function(obj)
{return Object.keys(obj).map(function(e){return obj[e];})[0];},showCampBuilderTestInfo:function()
{if(spApi.checkCampBuilderTest()||spApi.checkCampTest()){try{var inspectorInterval=setInterval(function(){sQuery('#spWorker').pm(function(){return sQuery.cookie('testInfo');},function(info){if(info!=null){clearInterval(inspectorInterval);info=spApi.Base64.decode(info);spApi.showTestInfoHtml(info);}});},1000);}catch(err){spApi.errLog(err,{logType:'showCampBuilderTestInfo',bugType:'product'});}}},checkPersonalizationTestByVariation:function(builderID,variationID){var candidateCookie=sQuery.cookie('variationCandidate');var variationCandidate=candidateCookie===null?{}:JSON.parse(candidateCookie);var testBuilder=typeof variationCandidate[builderID]!=='undefined';var testVariation=testBuilder&&(variationCandidate[builderID]===variationID);return spApi.checkCampBuilderTest()&&testVariation;},showTestInfoHtml:function(info)
{var inspectorId='insInspectorJs';if(!sQuery('#'+inspectorId).exists()){var script=document.createElement('script');script.type='text/javascript';script.async='async';script.id=inspectorId;script.src='//api.useinsider.com/js/inspector/inspector.js?v=0.0.5';document.head.appendChild(script);}},checkCampTest:function()
{if(document.referrer.indexOf(".panel.")==-1){return(spApi.hasParameter('campTest')||document.referrer.indexOf("campTest")>-1||sQuery.cookie('campCandidate')!=null)?true:false;}
return false;},getCampCandidate:function()
{try{var camp=sQuery.cookie("campCandidate");if(spApi.checkCampTest()&&spApi.hasParameter('camp'))
camp=spApi.Base64.decode(spApi.getParameter('camp'));else if(spApi.checkCampTest()&&document.referrer.indexOf("camp")>-1)
camp=spApi.Base64.decode(spApi.getParameterFromUrl(document.referrer,'camp'));return camp;}catch(err){spApi.errLog(err,{logType:'getCampCandidate',bugType:'product'});}},setCampTest:function()
{if(spApi.checkCampTest()){sQuery.cookie("campCandidate",spApi.getCampCandidate(),{path:'/',domain:cookieDomain});spApi.showCampBuilderTestInfo();}},triggerInspectorObserver:function(campId){if(spApi.showedCampaignList instanceof Array===false){spApi.showedCampaignList=[];}
if(spApi.showedCampaignList.indexOf(spApi.Base64.encode(campId))===-1){spApi.showedCampaignList.push(spApi.Base64.encode(campId));}
sQuery(document).trigger('inspectorCampaignShowed.insider');},triggerInspectorLogs:function(data){if(spApi.showedCampaignLogs instanceof Array===false){spApi.showedCampaignLogs=[];}
var encodedLogData=spApi.Base64.encode(data);if(spApi.showedCampaignLogs.indexOf(encodedLogData)===-1){spApi.showedCampaignLogs.push(encodedLogData);}
sQuery(document).trigger('inspectorCampaignLog.insider');},isTestModeOnJourney:function(journeyId){var testBuilderId=spApi.getObjectFirstKey(spApi.getCampBuilderCandidates());return spApi.getJourneyCamp(journeyId).builderIds.indexOf(testBuilderId)>-1;},eventManager:function(elementTarget){var trigger=function(eventStackId,event){event.stopImmediatePropagation();spApi.eventStack[eventStackId].callback();};return{on:function(eventType,delegatedElement,callback,multipleListenerOption){if(!elementTarget){spApi.logger('Specify element to set event on');return false;}
var bubbleOption=false;if(arguments.length===3){bubbleOption=true;if(typeof delegatedElement==='function'){multipleListenerOption=callback;callback=delegatedElement;}}else if(arguments.length===2){callback=delegatedElement;delegatedElement='';}
if(typeof callback!=='function'){spApi.logger('Callback must be a function.');return false;}
var eventStackId=spApi.hashCode(callback.toString());spApi.eventStack[eventStackId]={id:eventStackId,type:eventType,element:delegatedElement,captureElement:elementTarget,callback:callback,listenerOption:multipleListenerOption};var setListenerOnAll=function(){sQuery(elementTarget).on(eventType,delegatedElement,function(event){trigger(eventStackId,event);});sQuery(delegatedElement).on(eventType,function(event){trigger(eventStackId,event);});};var setListenerOnHead=function(){sQuery(elementTarget).on(eventType,delegatedElement,function(event){trigger(eventStackId,event);});};var setListenerOnCurrentElement=function(){sQuery(elementTarget).on(eventType,function(event){trigger(eventStackId,event);});};if(multipleListenerOption){setListenerOnAll();}else if(bubbleOption){setListenerOnHead();}else{setListenerOnCurrentElement();}},triggerEvent:function(type,delegatedElement,manualEventCallback){for(var stackId in spApi.eventStack){if(spApi.eventStack.hasOwnProperty(stackId)){var currentEvent=spApi.eventStack[stackId];var specifiedElement=delegatedElement||'';if(currentEvent.type===type&&currentEvent.captureElement===elementTarget&&currentEvent.element===specifiedElement){currentEvent.callback();(manualEventCallback||function(){}).call();}}}},refresh:function(){for(var stackId in spApi.eventStack){if(spApi.eventStack.hasOwnProperty(stackId)){var currentEvent=spApi.eventStack[stackId];spApi.eventManager(currentEvent.captureElement).on(currentEvent.type,currentEvent.element,currentEvent.callback,currentEvent.listenerOption);}}
spApi.logger('All Events has been refreshed');}}}};Object.setPrototypeOf=Object.setPrototypeOf||function(obj,proto){obj.__proto__=proto;return obj;};Object.setPrototypeOf(spApi,{uidExpireDate:365,eventStack:{},elementLoadCompleteConfig:{inited:false,autoExpireActivated:1,infinite:false,timeout:60*1000,mutableList:[]},apiInitConfig:{},allCamps:spApi.concat(spApi.concat(spApi.camps.concat(spApi.customizationCamps),spApi.webPushes),spApi.customSegments),currencyFormatRules:[],logTables:{"campLogs":"c","customLogs":"cu","mailRecommendationLogs":"mrl","customSegmentsLogs":"cs","goalBuilderLogs":"gb","insightLogs":"il","insightSalesLogs":"isl","webPushLogs":"w","webPushSalesLogs":"wps","journeyBuilderLogs":"jb","facebookMessengerLogs":"fb","facebookMessengerSalesLogs":"fbs"},systemRules:["categorySettings","getCartCount","getCategories","getCurrency","getCurrentProduct","getLang","getLocale","getOrderId","getPaidProducts","getProductCategories","getSearchKeyWords","getTotalCartAmount","isCouponCodeApplied","isOnAfterPaymentPage","isOnCartPage","isOnCategoryPage","isOnCouponPage","isOnMainPage","isOnProductPage","isOnRegSuccessPage","isUserLoggedIn","setEmailToCookie","sliderSettings","spAddToCart","triggerCartButton","useCouponButton"]});spApi.getPrototype=function(key){return spApi.__proto__[key];};spApi.objKeys=function(obj){return Object.keys(obj).length>0}
spApi.localStorageGet=function(storageName){try{return localStorage[storageName]||null;}catch(e){return null;}};spApi.localStorageSet=function(storageName,storeValue){try{return localStorage[storageName]=storeValue;}catch(e){return null;}};spApi.localStorageRemoveItem=function(storageName){try{return delete localStorage[storageName];}catch(e){return null;}};spApi.sessionStorageGet=function(storageName){try{return sessionStorage[storageName]||null;}catch(e){return null;}};spApi.sessionStorageSet=function(storageName,storeValue){try{return sessionStorage[storageName]=storeValue;}catch(e){return null;}};spApi.sessionStorageRemoveItem=function(storageName){try{return delete sessionStorage[storageName];}catch(e){return null;}};setEmailToCookie=function(name,value,expire,domain){if(spApi.validateEmail(value)){if(expire===undefined)
expire=365;if(domain===undefined)
domain=cookieDomain;sQuery.cookie(name,value,{expires:expire,path:'/',domain:domain});}};var setUserDataToCookie=(function(userData){if(userData==false||typeof(userData)=='undefined'){return false;}
var cookieName='insUserData';var save=function(createUserData){createUserData=JSON.stringify(createUserData);sQuery.cookie(cookieName,createUserData,{expires:360,path:'/',domain:cookieDomain});spApi.localStorageSet(cookieName,createUserData);}
var createUserData={};sQuery(userData.Login.button).live('click',function(){if(!spApi.validateEmail(sQuery(userData.Login.email).val()))return;if(sQuery.cookie(cookieName)!==null){var cookieContent=JSON.parse(sQuery.cookie(cookieName));createUserData=cookieContent;}
createUserData.email=sQuery(userData.Login.email).val();save(createUserData);});sQuery(userData.Register.button).live('click',function(){if(!spApi.validateEmail(sQuery(userData.Register.email).val())){return;}
createUserData.email=sQuery(userData.Register.email).val();createUserData.city=sQuery(userData.Register.city).val();createUserData.region=sQuery(userData.Register.region).val();createUserData.name=sQuery(userData.Register.name).val();save(createUserData);spApi.sessionStorageSet('isRegSuccess',1);});})(spApi.setEmailToCookie());spApi.timeOut=function(call,time){return setTimeout(function(){try{call();}catch(err){spApi.errLog(err,{logType:'setTimeout Error',bugType:'partner',extraData:{time:time,callback:call.toString()}});}},time);};spApi.interval=function(call,time){return setInterval(function(){try{call();}catch(err){spApi.errLog(err,{logType:'setInterval Error',bugType:'partner',extraData:{time:time,callback:call.toString()}});}},time);};spApi.ruleControl=function(rule,camp){try{rule.test=rule.test.replace(/setTimeout/g,'spApi.timeOut');rule.test=rule.test.replace(/setInterval/g,'spApi.interval');if(camp.isTest=="1"){return false;}else{return spApi.e(rule.test)===true;}}catch(err){var extraData={campaignName:spApi.decryptCampName(camp.campName),campaignId:camp.id};if(rule){extraData.ruleName=rule.name;extraData.ruleId=rule.id;extraData.ruleContent=rule.test}else{extraData.rule="undefined rule";}
spApi.errLog(err,{logType:'Rule Error',bugType:'partner',extraData:extraData});return false;}};spApi.campEventControl=function(eventName,callback){try{callback();}catch(err){spApi.errLog(err,{logType:'Campaign Event Error',bugType:'partner',extraData:{event:eventName,callback:callback.toString()}});}};spApi.isPageTranslatedWithGoogleTranslate=function(){var html=sQuery('html');return html.hasClass('translated-ltr')||html.hasClass('translated-rtl');};spApi.debugModeOpen=function(){if(spApi.debugMode){spApi.logger('info','Debug Mode Active');return true;}
spApi.debugMode=true;sQuery.cookie('spDebugMode',1,{expires:1,path:'/',domain:cookieDomain});spApi.logger('info','Debug Mode Active');};spApi.debugModeClose=function(){spApi.debugMode=false;sQuery.cookie('spDebugMode',null,{expires:1,path:'/',domain:cookieDomain});spApi.logger('info','Debug Mode Passive');};spApi.debugModeIsOpen=function(){return(spApi.debugMode||sQuery.cookie('spDebugMode')!==null)||false;};spApi.conLog=function(){if(spApi.debugModeIsOpen()&&typeof console.log!=='undefined'){console.log.apply(console,arguments);}};spApi.sentHitPayloads={pageView:{}};spApi.logger=function(type,message,campID){try{message=spApi.Base64.encode(message);if(typeof spApi.apiLogs==="undefined"){spApi.apiLogs={'camps':{},'general':[]};}
if(typeof campID!=="undefined"){if(typeof spApi.apiLogs.camps[campID]==="undefined"){spApi.apiLogs.camps[campID]=[];}
var logObject={'campID':campID,'type':type,'message':message,'time':new Date().getTime()};spApi.apiLogs.camps[campID].push(logObject)}
else{var logObject={'campID':campID,'type':type,'message':message,'time':new Date().getTime()};spApi.apiLogs.general.push(logObject)}
if(spApi.debugModeIsOpen()){if(type=='info'&&typeof console.info!=='undefined'){if(typeof campID==="undefined"){console.info(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.info(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}
else if(type=='warning'&&typeof console.warn!=='undefined'){if(typeof campID==="undefined"){console.warn(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.warn(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}
else if(type=='error'&&typeof console.error!=='undefined'){if(typeof campID==="undefined"){console.error(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.error(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}}}
catch(e){spApi.errLog(e);}
return true;};spApi.getLogs=function(campID){if(typeof spApi.apiLogs==="undefined"||spApi.apiLogs.length<1){return{};}
var logs={'camps':{},'general':[]};sQuery.each(spApi.apiLogs.camps,function(i,l){logs.camps[i]=[];sQuery.each(l,function(k,val){var logObject=sQuery.extend(true,{},val);logObject.message=spApi.Base64.decode(logObject.message);logs.camps[i].push(logObject);});});sQuery.each(spApi.apiLogs.general,function(i,val){var logObject=sQuery.extend(true,{},val);logObject.message=spApi.Base64.decode(logObject.message);logs.general.push(logObject);});if(typeof campID!=="undefined"){if(typeof spApi.apiLogs.camps[campID]!=="undefined"){return logs.camps[campID];}
return false;}
return logs;}
if(spApi.debugModeIsOpen()){spApi.logger('info','Debug Mode Active');}
function processAnalyticsResult(data){if(data&&typeof data.count!="undefined")
{return data.count;}
return 0;}
sQuery.fn.extend({pm:function(pmFunction,success,data){return this.each(function(){if(sQuery(this).is('iframe')){pm({target:sQuery(this)[0].contentWindow,type:'sQueryPM',data:{data:JSON.stringify(data),callback:encodeURI(pmFunction)},success:function(data){if(Boolean(success)){try{success(data);}catch(err){spApi.errLog(err,{logType:'PM Success Error (from window)',bugType:'partner',extraData:{params:JSON.stringify(data)||"",callback:String(success)}});}}}});}});}});pm.bind('storeLog',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
spApi.storeLog(data.table,data.logData);});pm.bind('sQueryPM',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
var result=null;try{result=spApi.e('('+decodeURI(data.callback)+')('+data.data+')');}catch(err){spApi.errLog(err,{logType:'PM Error (from window)',bugType:'partner',extraData:{campId:data.campId,params:JSON.stringify(data.data)||"",callback:String(decodeURI(data.callback))}});}
return result;});spApi.localStorageRemoveItem('insUserData');sQuery.cookie('insUserData',null,{expires:-1,path:'/',domain:partner_site.host});sQuery.cookie('insUserData',null,{expires:-1,path:'/',domain:'.'+partner_site.host});pm.bind('set-cookie',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
spApi.updateCookie(data);});pm.bind('get-cookie',function(data,event){if(!spApi.postMessageEventIsValid(event)){return false;}
var c=sQuery.cookie(data.key)!=null?sQuery.cookie(data.key):spApi.storageData(data.key);if(c){c=JSON.parse(c);return{err:null,response:c};}else{return{err:true,response:false};}});if(typeof spApi.worker=="undefined"&&(spApi.optOutRequestExists()||!spApi.isOptOut())){function insCreateUID(){var idStrLen=32;var spUID=(Math.floor((Math.random()*25))+10);spUID+=(new Date()).getTime();do{spUID+=(Math.floor((Math.random()*15))).toString(36);if(spUID.length==23)
spUID+=".";}while(spUID.length<idStrLen);return spUID;}
var dimensionControl=false;WorkerFrame=function(){sQuery(document).on('userLocationSet',function(){spApi.worker.userIP('setUserIp',{userLocation:spApi.storageData('userLocation')});});spApi.workerFrame=this;};WorkerFrame.prototype.initializeUserId=function(){if(!spApi.storageData('spUID')){spApi.storageData('spUID',insCreateUID(),{expires:spApi.getPrototype('uidExpireDate')});}else{spApi.storageData('spUID',spApi.storageData('spUID'),{expires:spApi.getPrototype('uidExpireDate')});}};WorkerFrame.prototype.ping=function(callback){spApi.executedCallbacks=[];try{spApi.workerFrame=this;var intervalId=setInterval(function(){if(sQuery('#spWorker').length>0){pm({target:sQuery('#spWorker')[0].contentWindow,type:'are-you-ready',data:{no:"data",noLog:window.noLog},success:function(data){if(!dimensionControl){spApi.gaDimensionQ=data.dimensionResults;spApi.logger('info','Worker is ready');dimensionControl=true;}
this._window=sQuery('#spWorker')[0].contentWindow;spApi.workerFrame.ready=true;sQuery(document).trigger('workerFrameReady');spApi.salesSesId=spApi.Base64.encode(spApi.getGAStyleSesId());spApi.setCampSalesSesId();clearInterval(intervalId);if(callback&&spApi.executedCallbacks.indexOf(callback.toString())===-1){spApi.executedCallbacks.push(callback.toString());callback();}}.bind(this)});}}.bind(this),10);}catch(err){}};WorkerFrame.prototype.send=function(type,data,callback){spApi.workerFrame=this;if(this.ready){if(data.type=='joined'){spApi.gaSend(data);}
else{data.userID=spApi.storageData('spUID');var checkLogKey=true;if(typeof data.type==='undefined'||typeof data.campId==='undefined'||data.goalType==='productCategorySuccess'||data.goalType==='productSuccess'){checkLogKey=false;}
var timestamp=Math.floor(new Date().getTime()/1000);var logKey=data.type+'-'+timestamp+'-'+data.campId;if(typeof spApi.logsStack[logKey]==='undefined'||checkLogKey===false){spApi.logsStack[logKey]='1';if(data.table){spApi.storeLog(data.table,data);}
spApi.logger('info','Worker ile '+data.type+' logu atıldı.',data.campId);if(data.type=='impression'||data.type=='join'||data.type=='camp-step1'||data.salesType=='sales'||data.salesType=='bounce-sales'||data.salesType=='variation-sales'||data.type=='closed'||data.type=='camp-step1-close'){spApi.gaSend(data);}
spApi.triggerInspectorLogs(JSON.stringify(data));}}}else{setTimeout(function(){spApi.workerFrame.send(type,data,callback);},1000)}};WorkerFrame.prototype.asyncPM=function(type,data,callback){spApi.workerFrame=this;if(this.ready){pm({target:this._window,type:type,data:data,success:callback});}else{setTimeout(function(){spApi.workerFrame.asyncPM(type,data,callback);},500);}};WorkerFrame.prototype.asyncFunc=function(func){spApi.workerFrame=this;if(this.ready){func();}else{setTimeout(function(){func();},500);}};WorkerFrame.prototype.userIP=function(type,data,callback){spApi.workerFrame=this;if(this.ready){pm({target:this._window,type:type,data:data,success:function(data){}});}else{setTimeout(function(){spApi.workerFrame.userIP(type,data,callback);},1000)}}
WorkerFrame.prototype.sendCook=function(type,data,callback){spApi.workerFrame=this;if(this.ready){pm({target:this._window,type:type,data:data,success:function(data){}});}else{setTimeout(function(){spApi.workerFrame.send(type,data,callback);},1000)}};WorkerFrame.prototype.check=function(o,n,campId,callback){try{if(!campId)
return;else if(o==undefined&&n==undefined)
return;spApi.workerFrame=this;var logType=[];sQuery.each(n,function(key,value){if(value==true){if(o==undefined||(o&&!o[key])){if(key=='step1-displayed'){logType.push('camp-step1');}else if(key=='step1-closed'){logType.push('camp-step1-close');}else if(key=='closedCouponTimer'){logType.push('closedCouponTimer');}else if(key=='couponAppliedTimer'){logType.push('couponAppliedTimer');}else if(key=='closed'){}else{logType.push(key);}}}});sQuery.each(logType,function(key,value){spApi.workerFrame.send('do-logging',{type:value,campId:campId,table:n.table},callback);});}catch(err){}};WorkerFrame.prototype.cookie=function(capsule,callback){spApi.workerFrame=this;spApi.workerFrame.sendCook(capsule.dataC.type,{data:capsule.dataC.cookie,key:capsule.dataC.key});};spApi.worker=new WorkerFrame();spApi.worker.ping();spApi.loaded=true;}
if(spApi.isBrowserSupportEnabled()){function parseLocationData(data){}
function parseWeatherData(data){}
function parsePredictiveData(data){}
function parseCustomDataSet(data){}
window.insiderPermissionLogCallback=function(){};var isExternalServicesEnabled='1';var _flushPredictiveData=function(){var optionalSegmentList=["b9d78018a94e93a300d32ad4a05355c9"];var predictiveData=JSON.parse(spApi.storageData('predictiveData'));var newKeyExists=false;optionalSegmentList.forEach(function(segmentKey){if(typeof predictiveData[segmentKey]==='undefined'){newKeyExists=true;}});if(newKeyExists){return true;}
return false;};function loadUserLocation(){if(!isExternalServicesEnabled){return false;}
try{sQuery.ajax({url:'https://location.api.useinsider.com/?pId=10003302',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseLocationData",success:function(data){var geoData={geoId:'',city:'',country:'',cName:'',request:'',latitude:'',longitude:''};if(spApi.objKeys(data)){geoData.geoId=data.cityNameId;geoData.city=data.cityName;geoData.country=data.countryCode;geoData.cName=data.countrName;geoData.request=data.ip;geoData.latitude=data.latitude;geoData.longitude=data.longitude;spApi.storageData('userLocation',geoData,{expires:1});}else{spApi.storageData('userLocation',geoData,{expires:1});}
sQuery(document).trigger('userLocationSet');}});}catch(err){spApi.errLog(err);}}
function loadPredictiveData(callback){try{if(setPredictiveData&&(!spApi.storageData('predictiveData')||spApi.unificationEventSucceed||_flushPredictiveData())&&typeof window.predictiveSet==='undefined'&&isExternalServicesEnabled){window.predictiveSet=true;sQuery.ajax({url:'//segment.api.useinsider.com/v4/segments/'
+spApi.storageData('spUID')
+'?partnerid=10003302&jsonp=true&fields=b9d78018a94e93a300d32ad4a05355c9',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parsePredictiveData",success:function(data){var expireDate=1;if(typeof data['3ab354153f5c1cf6338dc223c21965a0']!=='undefined'){var date=new Date();expireDate=new Date(date.setTime(date.getTime()+data['3ab354153f5c1cf6338dc223c21965a0']));}
spApi.storageData('predictiveData',data,{expires:expireDate});if(typeof callback!=='undefined'){callback();}}});}}catch(err){spApi.errLog(err);}}
function getDataset(segmentList){var loopCounter=Math.floor(segmentList.length/30);var segmentListForDataList=[];for(var i=0;i<=loopCounter;i++){segmentListForDataList[i]=segmentList.slice(i*30,(i+1)*30);var callbackName='insParseCustomDataSet'+i;window[callbackName]=function(data){};sQuery.ajax({url:spApi.apiUrl+'customDataSegmentation.php',type:'POST',data:{segmentList:JSON.stringify(segmentListForDataList[i]),callback:callbackName,counter:i},dataType:'jsonp',async:spApi.isAjaxAsync,jsonpCallback:callbackName,success:function(dataset){if(dataset.success){sQuery.each(dataset.success,function(segmentName,result){sQuery.each(segmentListForDataList[dataset.counter],function(index,segment){if(segmentName===segment.sn){var key='customDataSet-'+segmentName;var data={status:result,cookie:segment.cv};localStorage.setItem(key,JSON.stringify(data));}});});}}});}}
function loadCustomDataSet(customDataset){try{var segmentList=[];sQuery.each(customDataset,function(index,rule){if(typeof rule!=='undefined'){var regex=/checkCustomDataset\(([^)]+)\)/g
var matches=[];var match=regex.exec(rule.test.replace(/[^()-_,\w\s]/gi,''));while(match!=null){matches.push(match[1]);match=regex.exec(rule.test.replace(/[^()-_,\w\s]/gi,''));}
sQuery.each(matches,function(index,ruleTest){var ruleMatch=ruleTest.split(',');if(typeof ruleMatch['1']!=='undefined'){var cookieKey=ruleMatch['0'];var segmentName=ruleMatch['1'].trim();if(typeof rule.isProcessed!=='undefined'&&rule.isProcessed){var cookieValue=sQuery.cookie(cookieKey);var key='customDataSet-'+segmentName;var customSet=JSON.parse(localStorage.getItem(key));if(!customSet||typeof customSet=='number'||(typeof customSet=='object'&&customSet.cookie!=cookieValue)){if(cookieValue){var data={cv:cookieValue,sn:segmentName};segmentList.push(data);}else{var data={status:0,cookie:cookieValue};localStorage.setItem(key,JSON.stringify(data));}}else if(!cookieValue&&customSet.status){var data={status:0,cookie:cookieValue};localStorage.setItem(key,JSON.stringify(data));}}}});}});if(segmentList.length){getDataset(segmentList);}}catch(err){spApi.errLog(err,{logType:'loadCustomDataSet',bugType:'product',extraData:{customDataset:customDataset}});}}
try{var now=new Date();var customDataset=[];var setPredictiveData=false;if(!spApi.isSiteUrlCheckFailed()){sQuery.each(spApi.rules,function(i,val){rule=spApi.rules[i];if(rule.test.indexOf("Predictive")>-1||rule.test.indexOf("BehavioralSegments")>-1||rule.test.indexOf("checkAdAudience")>-1||rule.test.indexOf("checkCrmAttributeData")>-1){var localStorageValue=JSON.parse(localStorage.getItem('predictiveData'));if(localStorageValue!==null&&typeof localStorageValue.expireDate!=='undefined'){if(localStorageValue.expireDate>(new Date()).getTime()){spApi.storageData('predictiveData',localStorageValue,{expires:(new Date(localStorageValue.expireDate))});}else{setPredictiveData=true;}}else{if(!spApi.storageData('predictiveData')||_flushPredictiveData()){setPredictiveData=true;}}}
if(rule.test.indexOf("CustomDataset")>-1){customDataset[rule.id]=rule;}});}
if(customDataset.length){loadCustomDataSet(customDataset);}
var userLocationData='';if(true){userLocationData=JSON.parse(spApi.storageData('userLocation'));if(!userLocationData){loadUserLocation();}}
var callDataFunctions=function(){loadPredictiveData();};if(true&&spApi.localStorageGet('insdrSV')==sQuery.cookie('insdrSV')){spApi.init();callDataFunctions();}else{spApi.logger('info','Partner storage mismatch, waiting for worker...');var insStorageInterval=setInterval(function(){if(spApi.worker.ready){pm({target:sQuery('#spWorker')[0].contentWindow,type:'storageData',data:{action:'read'},success:function(storageData){try{spApi.logger('info','Waiting for worker to making partner data syncronized');sQuery.each(storageData,function(property,value){spApi.localStorageSet(property,value);});spApi.localStorageSet('insdrSV',sQuery.cookie('insdrSV'));spApi.init();callDataFunctions();spApi.logger('info','API initialized');}catch(error){spApi.errLog(error);}}});clearInterval(insStorageInterval);}},100);}}catch(err){spApi.errLog(err);}
function setLocalStorage(storageName,storeValue){localStorage.setItem(storageName,JSON.stringify(storeValue));}
function getLocalStorage(storageName){try{return JSON.parse(localStorage.getItem(storageName))}catch(err){setLocalStorage(storageName,'');return[];}}
var isLocalStorageExist=function(storageName){var val=getLocalStorage(storageName);if(val!==null&&val!='\"\"'&&val!='')
return true;else
return false;}
function spGetTime(){return Math.round(new Date()/1000+3600);}
try{var uVDate=[];if(isLocalStorageExist('userDateV'))
uVDate=getLocalStorage('userDateV');if(uVDate.length==0||spGetTime()-uVDate[uVDate.length-1]>1800){uVDate.push(spGetTime());setLocalStorage('userDateV',uVDate);}
if(spApi.isOnAfterPaymentPage()){var userpaids=[];var paid={};if(spApi.storageData("paid-products")!=null&&spApi.storageData("paid-products").length>0){if(isLocalStorageExist('userpaids')){userpaids=getLocalStorage('userpaids');paid=sQuery.merge(JSON.parse(spApi.storageData("paid-products")),userpaids);}else{paid=JSON.parse(spApi.storageData("paid-products"));}
setLocalStorage('userpaids',paid);}}
if(spApi.isUserLoggedIn()){if(!isLocalStorageExist('loggedinUser'))
setLocalStorage('loggedinUser',1);}}catch(err){spApi.errLog(err);}}
else{spApi.consoleLog.push("Not supporting Internet Explorer 10 or below.");}}
spApi.loadScript('//api.useinsider.com/js/squery.min.js',insiderMain);(function(){var i=setInterval(function(){if(document.body){var workerFrame=document.createElement('iframe');workerFrame.style.display='none';workerFrame.id='spWorker';workerFrame.src='https://ilotteidstaging.api.useinsider.com/worker.html';document.body.appendChild(workerFrame);clearInterval(i);}});setTimeout(function(){clearInterval(i)},5000);})();}else{var errorTwice="Warning : API is integrated more than once";(spApi.consoleLog==undefined)?spApi.consoleLog=[errorTwice]:spApi.consoleLog.push(errorTwice);}(function(){window.API_VERSION_ilotteidstaging='v2.7.2';})();