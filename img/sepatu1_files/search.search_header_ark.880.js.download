var g_oConvert="fw",isArk=!0,isKeydown=!1,isListShow=!0,cursorPos=-1,formName="#searchHeaderForm",queryId="#headerQuery",arkId="#srch_ark",categoryId="#recommendCategory_area",totalFwCount=0,totalRwCount=0,target="",charset="utf-8",baseUrl=CONSTANTS.baseUrl,arkUrl=baseUrl+"api/common/search/getArk",tempQuery="",BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||
"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,e=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(-1!=c.indexOf(a[b].subString))return a[b].identity}else if(e)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(-1!=b)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",
identity:"CHROME"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.Vendor,subString:"Apple",versionSearch:"Version",identity:"Safari"},{prop:window.opera,identity:"OPERA",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"FF"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},
{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"IE",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win32",identity:"Windows"},{string:navigator.platform,subString:"Wind",identity:"Windows"},{string:navigator.platform,subString:"Mac",
identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();var browser=BrowserDetect.browser,browserVersion=BrowserDetect.version,os=BrowserDetect.OS;
$(document).ready(function(){"OPERA"==browser||"FF"==browser?$(document).keydown(function(a){$(queryId).val();38!=a.which&&40!=a.which&&$(a.target).is(queryId)&&(isKeydown=!0,eventKeydown())}):"IE"!=browser&&"CHROME"!=browser&&"Mozilla"!=browser||$(document).keyup(function(a){var b=$(queryId).val();38!=a.keyCode&&40!=a.keyCode&&16!=a.keyCode&&(8==a.keyCode&&""==b?$(a.target).is(queryId)&&showPopKeyword():$(a.target).is(queryId)&&(isArk?requestArkJson($(queryId).val()):""==$(queryId).val()&&showPopKeyword()))});
$(queryId).keyup(function(a){8==a.keyCode&&""==$(this).val()&&showPopKeyword()});$(document).click(function(a){stopEventBubble(a);var b=$(queryId).val();$(a.target).is(queryId)&&isArk&&(""!=b?(requestArkJson($(queryId).val()),keyword=b):showPopKeyword(),isKeydown=!0)})});function stopEventBubble(a){a="undefined"!==typeof a?a:event;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}
function requestArkJson(a){jQuery.support.cors=!0;cursorPos=-1;var b=indolotte.front.ec.search.search_header.filteringXSS(a),c="Keywords with \x26quot;\x3cb\x3e"+b+"\x3c/b\x3e\x26quot;";$("#displayQuery").html(c);$("#arkFrm").children("input[name\x3d'query']").val(b);$("#arkFrm").children("input[name\x3d'target']").val("common");b=indolotte.front.ec.search.search_header.objToJson($("#arkFrm").serializeArray());indolotte.common.Ajax.sendJSONRequest("POST",arkUrl,b,function(b){var c=b.items,d="\x3cul class\x3d'list_words'\x3e";
0<b.totalCount?$.each(c,function(a,b){d+="\x3cli\x3e\n";a=getKeywordHl(b.hkeyword,"\x3cb class\x3d'b_marked'\x3e","\x3c/b\x3e");d+="\x3ca href\x3d\"javascript:indolotte.front.ec.search.search_header.doKeywordSearch('"+b.keyword+"');\" class\x3d'keyword'\x3e"+a+"\x3c/a\x3e\n";d+="\x3c/li\x3e\n"}):(d+="\x3cli\x3e\n",d+="\x3ca href\x3d\"javascript:;\" class\x3d'keyword'\x3e\x3cb class\x3d'b_marked'\x3eno keyword\x3c/b\x3e\x3c/a\x3e\n",d+="\x3c/li\x3e\n");d+="\x3c/ul\x3e";$(arkId).html(d);$(categoryId).hide();
1>a.length||null==a||showArk()},!0,!0);$("#arkFrm").children("input[name\x3d'target']").val("category");b=indolotte.front.ec.search.search_header.objToJson($("#arkFrm").serializeArray());indolotte.common.Ajax.sendJSONRequest("POST",arkUrl,b,function(b){str="";var c=b.categories;0<b.cateCount?(str+="\x3cdiv class\x3d'keywords_recomm' \x3e\n",str+="\x3cstrong class\x3d'tit_recomm'\x3eRecommended Categories\x3c/strong\x3e",str+="\x3cul class\x3d'list_ctgs'\x3e",$.each(c,function(a,b){str+="\x3cli\x3e\x3ca href\x3d\"javascript:indolotte.front.ec.display.common.moveCategory('"+
b.categoryNo+"');\"\x3e"+b.categoryFullName+"\x3c/a\x3e\x3c/li\x3e"}),str+="\x3c/ul\x3e",str+="\x3c/div\x3e",$(categoryId).show(),$(categoryId).html(str)):$(categoryId).hide();1>a.length||null==a||showArk()},!0,!0)}var keyword="";function eventKeydown(){isKeydown&&(keyword!=$(queryId).val()&&(keyword=$(queryId).val(),""!=keyword&&isArk?requestArkJson($(queryId).val()):hideArk()),setTimeout("eventKeydown()",20))}function onClickKeyword(a){a=$("#f"+a).text();doKeywordSearch(a)}
function showArk(){$("#viewsrch_keyword2").hide();$("#viewsrch_keyword1").show()}function hideArk(){$("#viewsrch_keyword1").hide();$("#viewsrch_keyword2").hide()}function showPopKeyword(){$("#viewsrch_keyword1").hide();$("#viewsrch_keyword2").show()}function getKeywordHl(a,b,c){null!=a&&(a=a.replace("\x3cfont style\x3d'color:#CC6633'\x3e",b),a=a.replace("\x3c/font\x3e",c),a=a.replace("\x3cfont style\x3d'font-size:13px'\x3e",""),a=a.replace("\x3c/font\x3e",""));return a};