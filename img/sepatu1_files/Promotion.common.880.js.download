$.namespace("indolotte.front.pm.Common");
indolotte.front.pm.Common={DATE_FORMAT:"dd/MM/yyyy",DATE_FORMAT_STR_MONTH:"dd.MMM.yyyy",DATETIME_FORMAT:"dd/MM/yyyy HH:mm:ss",MARKETING_AJAX_LODING_DIMM_OPEN_COUNT:0,checkEmpty:function(a){return"undefined"==String(a)||null==a||""==a?!0:!1},checkNotEmpty:function(a){return"undefined"==String(a)||null==a||""==a?!1:!0},defaultEmpty:function(a,b){return"undefined"==String(a)||null==a||""==a?b:a},checkNull:function(a){return"undefined"==String(a)||null==a?!0:!1},checkNotNull:function(a){return"undefined"==
String(a)||null==a?!1:!0},defaultNull:function(a,b){return"undefined"==String(a)||null==a?b:a},checkLoginStatus:function(){return this.checkNotEmpty(getCurrentUser())?getCurrentUser().isLoggedIn:!1},alert:function(a,b){this.checkEmpty(a)||($("#MARKETING_ALERT_MESSAGE_AREA").html(a),"function"===typeof b?($("#BTN_MARKETING_ALERT_OK").unbind("click"),$("#BTN_MARKETING_ALERT_OK").click(function(){b(!0);$.fancybox.close()}),$.fancybox({modal:!0,content:$("#MARKETING_ALERT_LAYER"),autoCenter:!0,helpers:{overlay:{locked:!1}},
closeBtn:!1,padding:0,margin:0,arrows:!1,tpl:{wrap:'\x3cdiv class\x3d"fancybox-wrap" tabIndex\x3d"-1"\x3e\x3cdiv class\x3d"fancybox-skin" style\x3d"border-radius:5px;"\x3e\x3cdiv class\x3d"fancybox-outer"\x3e\x3cdiv class\x3d"fancybox-inner"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'}})):($.fancybox($("#MARKETING_ALERT_LAYER")),$("#BTN_MARKETING_ALERT_OK").unbind("click"),$("#BTN_MARKETING_ALERT_OK").click(function(){$.fancybox.close()})))},confirm:function(a,b){this.checkEmpty(a)||"function"!=
typeof b||($("#MARKETING_CONFIRM_MESSAGE_AREA").html(a),$("#BTN_MARKETING_CONFIRM_OK").unbind("click"),$("#BTN_MARKETING_CONFIRM_OK").click(function(){"function"===typeof b&&b(!0);$.fancybox.close()}),$("#BTN_MARKETING_CONFIRM_CANCEL").unbind("click"),$("#BTN_MARKETING_CONFIRM_CANCEL").click(function(){"function"===typeof b&&b(!1);$.fancybox.close()}),$.fancybox({modal:!0,content:$("#MARKETING_CONFIRM_LAYER"),autoCenter:!0,helpers:{overlay:{locked:!1}},closeBtn:!1,padding:0,margin:0,arrows:!1,tpl:{wrap:'\x3cdiv class\x3d"fancybox-wrap" tabIndex\x3d"-1"\x3e\x3cdiv class\x3d"fancybox-skin" style\x3d"border-radius:5px;"\x3e\x3cdiv class\x3d"fancybox-outer"\x3e\x3cdiv class\x3d"fancybox-inner"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'}}))},
getCodeName:function(a,b){if(this.checkEmpty(a.codes)||0==a.codes.length||this.checkEmpty(a.values)||0==a.values.length||a.codes.length!=a.values.length)return"";var d="";$.each(a.codes,function(e,c){c==b&&(d=a.values[e])});return d},formatDate:function(a,b){if(this.checkEmpty(a)||this.checkEmpty(b))return b;var d;if("string"==typeof b)if(8!=b.length)d=b;else{var e=b.substring(0,4),c=b.substr(4,2),k=b.substr(6,2);d=a.replace(/(yyyy|yy|MM|dd|E|hh|mm|ss|a\/p)/gi,function(a){return"yyyy"==a?e:"MM"==
a?c:"dd"==a?k:""})}else if("number"==typeof b){var g=function(a){return 10<=a?a:"0"+a},f=new Date(b),l="January February March April May June July August September October November December".split(" ");d=a.replace(/(yyyy|yy|MMM|dd|E|hh|mm|ss|a\/p)/gi,function(a){return"yyyy"==a?f.getFullYear():"yy"==a?g(f.getFullYear()%1E3):"MM"==a?g(f.getMonth()+1):"MMM"==a?l[f.getMonth()].substring(0,3):"dd"==a?g(f.getDate()):"HH"==a?g(f.getHours()):"hh"==a?g((h=f.getHours()%12)?h:12):"mm"==a?g(f.getMinutes()):
"ss"==a?g(f.getSeconds()):a})}return d},formatMoney:function(a){return indolotte.front.pm.Common.checkNotEmpty(a)?(a+"").replace(/\B(?=(\d{3})+(?!\d))/g,"."):""},removeArrayDuplicate:function(a){for(var b={},d=0;d<a.length;d++)"undefined"==typeof b[a[d]]&&(b[a[d]]=1);a.length=0;for(d in b)a[a.length]=d;return a},issueCodeVoucher:function(){var a=indolotte.front.pm.Common;if(a.checkNotEmpty($("#codeVoucherNumber").val())){var b={codeVoucherNumber:$("#codeVoucherNumber").val()},b=$.param(b);indolotte.common.Ajax.sendJSONRequest("get",
CONSTANTS.baseUrl+"pm/issueVoucher.do",b,function(b){$("#codeVoucherNumber").val("");"Y"===b.successYN?"function"===typeof document.callVoucherLayerCallBack?b.message&&a.alert(b.message,document.callVoucherLayerCallBack):b.message&&a.alert(b.message):b.message&&a.alert(b.message)})}else $("#voucherAreaErrorMSG").text(MESSAGES.format("pm.js.common.message.PM-002")),$("#voucherAreaErrorMSG").show()},removeUrlParameter:function(a){if(a&&window.location.search&&0<window.location.search.length){urlParameters=
decodeURI(window.location.search.substring(1)).split("\x26");newUrlParameters="";for(i=0;i<urlParameters.length;i++)key=urlParameters[i].split("\x3d")[0],a!=key&&(newUrlParameters+=urlParameters[i]+"\x26");window.history.replaceState(null,null,"?"+newUrlParameters.substring(0,newUrlParameters.length-1))}},renderingChannelVoucher:function(a,b,d){var e=this,c=indolotte.front.pm.Common;"Y"===b&&c.setChannelRequestProcessed();e.removeUrlParameter(CHANNEL_REQUEST_PARAMETER_KEY_CH_DOWNLOAD_FLAG);if(c.checkLoginStatus()){if("Y"==
c.defaultEmpty(b,"Y")){e.requestRemoveChannelSession();"Y"==d&&c.alert(MESSAGES.format("common.js.message.PM-004")+'\x3cbr\x3e\x3ca href\x3d"/me/voucher/viewListOfMyAvailableVoucher.do" class\x3d"popupBoxLink"\x3e'+MESSAGES.format("common.js.message.showmyvoucher")+"\x3c/a\x3e");return}if("Y"==d){e.issueChannelVoucher();return}$("#issuedYesChannelVoucherArea").hide();$("#issuedNoChannelVoucherArea").show();$("#btn_issueChannelVoucher").unbind("click");$("#btn_issueChannelVoucher").click(function(a){a.preventDefault();
e.issueChannelVoucher()})}else $("#btn_issueChannelVoucher").click(function(a){e.requestRemoveChannelSession();indolotte.common.Biz.login.goToLogin(!0,CHANNEL_REQUEST_PARAMETER_KEY_CH_DOWNLOAD_FLAG+"\x3dY")});$("#channelVoucherListArea").empty();null!=(new URLSearchParams(window.location.search)).get("ch")&&(c.checkNotEmpty(a)&&0<a.length?($.each(a,function(a,b){b.marketingBenefitTypeCodeName=c.getCodeName(CONSTANTS.pm.CODE_LIST_MA034,b.marketingBenefitTypeCode);a="";"3001"===b.marketingBenefitTypeCode?
a="product":"3002"===b.marketingBenefitTypeCode?a="order":"3003"===b.marketingBenefitTypeCode?a="delivery":"3005"===b.marketingBenefitTypeCode&&(a="gift");b.title="";""!==a&&(b.title=MESSAGES.format("common.js.popup.voucher.title."+a));b.cssStyleType="";""!==a&&(b.cssStyleType="voucher-container--"+a);b.usePeriodApplyDesc="";"01"===b.voucherUsePeriodApplyCode?(b.usePeriodApplyDesc=c.formatDate(c.DATE_FORMAT_STR_MONTH,b.voucherUseStartDateTime),b.usePeriodApplyDesc+=" ~ ",b.usePeriodApplyDesc+=c.formatDate(c.DATE_FORMAT_STR_MONTH,
b.voucherUseEndDateTime)):"02"===b.voucherUsePeriodApplyCode&&(b.usePeriodApplyDesc="Expires in "+b.voucherAfterIssuanceUseDayCount+" days after Download");c.checkNotEmpty(b.rateAmountApplyWayCode)&&c.checkNotEmpty(b.benefitValue)&&"01"==b.rateAmountApplyWayCode&&(b.benefitValue=c.formatMoney(b.benefitValue));b.applyCriterionMinimumOrderAmountDesc="";c.checkNotEmpty(b.applyCriterionMinimumOrderAmount)?(b.applyCriterionMinimumOrderAmount="Rp "+c.formatMoney(b.applyCriterionMinimumOrderAmount),b.applyCriterionMinimumOrderAmountDesc=
"Min.Purchase "+b.applyCriterionMinimumOrderAmount+",-"):b.applyCriterionMinimumOrderAmount="-"}),$("#channelVoucherListArea").append($("#tmpl_channelVoucherList").tmpl({voucherList:a})),$.fancybox($("#channelVoucherArea"),{padding:0,margin:0,helpers:{overlay:{closeClick:!1}}})):$("#channelVoucherListArea").append($("#tmpl_channelVoucherList").tmpl()))},issueChannelVoucher:function(){var a=indolotte.front.pm.Common;a.checkLoginStatus()&&indolotte.common.Ajax.sendJSONRequest("get",CONSTANTS.baseUrl+
"pm/issueChannelVoucher.do","",function(b){"Y"===b.successYN?b.message&&(indolotte.front.pm.Common.requestRemoveChannelSession(),a.alert(b.message)):b.message&&a.alert(b.message)})},setChannelRequestProcessed:function(){indolotte.common.Ajax.sendRequest("get",CONSTANTS.baseUrl+"api/ch/setChannelRequestProcessed","",function(a){})},requestRemoveChannelSession:function(){indolotte.common.Ajax.sendJSONRequest("get",CONSTANTS.baseUrl+"api/ch/removeChannelSession","",function(a){},!1)},getIssuedVoucherCountOfMember:function(){indolotte.common.Ajax.sendRequest("get",
CONSTANTS.baseUrl+"api/pm/getIssuedVoucherCountOfMember","",function(a){200==a.code&&"undefined"!=String(a.data)&&null!=a.data&&""!=a.data&&$("#issuedVoucherCount").text(a.data)})}};